---
output: 
    pdf_document:
        fig_caption: yes
        number_sections: true
header-includes:
- \usepackage{float}
---

#Business Sentiment and the Business Cycle in South Africa
##Introduction
The global financial crisis was associated with unusually low levels of confidence and heightened uncertainty. According to the @ECB2013, weak business sentiment contributed to a large extent to the Great Recession and the lacklustre subsequent recovery. More recently, uncertainty has increased sharply in the wake of Britain's EU referendum [@Stewart2016] and the US presidential election [@Rampell2017]. The idea that weak business sentiment influenced economic activity has inspired a large literature examining the impact of changes in sentiment, and especially uncertainty, on real economic activity. The idea is that firms' perceptions of the future affect their investment and production decisions, which in turn affect real economic activity [@ECB2013]. 

Business sentiment refers to two distinct concepts: *confidence* and *uncertainty*. Business confidence has generally not been clearly defined in the literature. For the purposes of this chapter, business confidence involves firms' perceptions of, or degree of optimism regarding, current and future business conditions. Business uncertainty reflects the inability of firms to forecast the probability of future events occurring [@Knight1921]. Both are elusive concepts that are difficult to define precisely or measure directly [@Santero1996]. The imprecise definition of confidence and uncertainty makes it difficult to construct proxies and calls for various measures of both concepts.

Analysts typically aggregate information from business and consumer surveys to construct proxies for confidence. Popular confidence indicators include the European Commission's Economic Sentiment Index and the Ifo Business Climate Indicator in Germany [@INIS2014]. A wide range of proxies for uncertainty have been proposed in the literature, including measured based on financial market information, forecaster disagreement and business tendency surveys. 

To date there has been little research on business sentiment in South Africa, in part due to the difficulty of measurement. Only two business confidence indicators are regularly published for South Africa: the SACCI BCI and the BER BCI. The SACCI BCI is a composite measure of economic activity, rather than a confidence indicator in the way used in the literature. The BER BCI is a measure of confidence derived from the BER's business tendency surveys. The BER BCI is based on a single question on current conditions. The survey responses are weighted in an ad hoc manner and the services sector survey is excluded from the calculation. Only a few studies have created proxies for uncertainty in South Africa (e.g. @Redl2015 and @Hlatshwayo2016). No study has fully exploited the information contained in the BER business tendency surveys to construct proxies for business uncertainty in South Africa. 

The primary aim of this chapter is to explore aggregation methods to estimate proxies for business confidence and uncertainty using the microeconomic data from the BER business tendency surveys. Although measuring business sentiment is challenging, survey-based indicators can be helpful in discovering agents' opinions on future economic developments [@OECD2003]. Survey-based measures have the advantage that they are derived from opinions of key economic agents [@Girardi2015], are available earlier than official statistics and are usually not subject to revisions [@ECB2013]. 

The challenge in aggregating the microeconomic data from the BER business tendency surveys is to identify an underlying pattern from the disparate views of individual agents. The chapters tries to capture the full distribution of the qualitative survey responses, by calculating the first and second weighted cross-sectional moments of the distribution. The composite indicators of business confidence and uncertainty are based on these moments. Two composite confidence indicators are calculated as the cross-sectional mean of responses to questions on current and expected future business conditions [@OECD2003]. Three composite uncertainty indicators are calculated as the cross-sectional dispersion of forward-looking responses and the cross-sectional mean and dispersion of individual firm expectation errors [@Arslan2011; @Bachmann2013; @Girardi2015].

The composite indicators incorporate the survey responses from a number of questions, maintaining a distinction between current and expected future conditions. The responses are weighted to produce sectoral and aggregate indicators, which are analysed separately. The indices also incorporate the services sector, which is not included in the BER BCI. Whereas the previous chapter constructed various quality-adjusted measures of the mean of the distribution of growth rates, this chapter calculates various measures of the mean and variance of survey responses, as proxies for confidence and uncertainty.

The internal and external validity of the indicators are assessed by comparing the different composite indicators to each other, and to the existing measures of confidence and uncertainty in South Africa. The two confidence indicators are compared to the BER BCI and the SACCI BCI, while the three composite uncertainty indicators are compared to a measure of financial market uncertainty and the economic policy uncertainty indicator created by @Hlatshwayo2016. In addition, the chapter constructs a composite overall measure of uncertainty, which combines the survey-based uncertainty indicators with the measures of financial market and economic policy uncertainty.

The sentiment indicators are then evaluated according to their comovement with real GDP growth (i.e. their tracking record), in order to assess whether they are able to improve upon the existing indicators. The leading indicator properties of the confidence indices are also evaluated, in terms of the timing of turning points and concordance with the official SARB business cycle. 

The secondary aim of this chapter is to examine the relationship between business sentiment and real economic activity in South Africa, by testing the hypothesis that there is significant comovement between the sentiment indicators and real GDP growth, using the standard VAR framework. There has been very little analysis of the impact of business sentiment on real economic activity in the South African context (e.g. @Pellissier2002 and @Redl2015). The chapter investigates the relationship between the indicators and real GDP growth, including the timing of this relationship and the extent to which correlation is conditional on other economic variables. The following section provides a review of the literature on business confidence and uncertainty.

##Confidence
The literature has been interested in the role of sentiment in driving business cycles, as firms' perceptions about the future impact their investment and production decisions [@ECB2013]. Confidence indicators, typically based on surveys, try to measure one aspect of sentiment [@Akerlof2015]. Business confidence in this context has generally not been clearly defined, nor is it always clear whether these indicators measure a well-defined economic concept, or are a vague gauge of agents' disposition [@Ludvigson2004; @VanAarle2012]. For the purposes of this chapter, business confidence involves firms' perceptions of, or degree of optimism regarding, current business conditions and the expected future business climate [@Mendicino2013]. 

###Macro Theory and Confidence
Early business cycle theories argued that economic activity may be driven partly by sentiment [@Leduc2010]. @Pigou1927, for instance, argued that "*varying expectations of business men.constitute the immediate cause and direct causes or antecedents of industrial fluctuations (...) wave-like swings in the mind of business world between errors of optimism and errors of pessimism.*" According to this view, when firms are optimistic about future demand and profits, they decide to accumulate capital. If their expectations are not met, there will be a period of reduced investment that may cause a recession [@Beaudry2004]. Firms make errors in their expectations about future demand and profits due to waves of optimism and pessimism. These errors generate cycles through increases and decreases in investment [@Leduc2010]. 

@Keynes1936 argued that sentiment plays an important role in economic fluctuations: "*Our decisions to do something positive, the full consequence of which will be drawn out over many days to come, can only be taken as a result of animal spirits - of a spontaneous urge to action rather than inaction, and not as the outcome of a weighted average of quantitative benefits multiplied by quantitative probabilities.*" According to this view, sentiment or animal spirits are a main driver of investment decisions in the face of uncertainty due to the difficulty of making forecasts [@Pagan2013].

The idea that sentiment plays an important role in predicting economic activity may appear to be inconsistent with the rational expectations framework [@Beaudry2004]. For instance, modern theories of consumption (e.g. the life-cycle and permanent-income theories) suggest that consumer confidence should have no predictive power for future consumption, as current spending should fully reflect the relative optimism of consumers about future prospects [@Carroll1994]. From the rational expectations point of view, confidence indices should reflect the expected values of the macroeconomic fundamentals and should not offer any additional information.

A number of theories have argued for a potential theoretical link between confidence and economic activity. For instance, an increase in confidence may reflect higher future income, but frictions in capital markets such as borrowing constraints can prevent higher current consumption in anticipation of an increase in income. As a result, consumption will increase only when actual income increases, and a rise in consumer confidence will predict the future consumption rise [@ECB2013]. 

An increase in consumer confidence may predict future consumption if some consumers follow a "rule-of-thumb", consuming some portion of current income in every period [@Campbell1987; @Ludvigson2004]. When economic prospects are positive, consumers that are forward-looking will give optimistic responses to surveys. The optimistic expectations are confirmed on average and income will increase. Spending by the portion of consumers that follow the rule-of-thumb will then increase. Thus, the survey responses of forward-looking consumers predict the spending of rule-of-thumb consumers [@Carroll1994].

@Beaudry2004 analysed models where agents receive imperfect signals about future productivity growth and use these signals to make investment decisions. In this context, optimism refers to a state where agents receive an above-average signal. These signals generate waves of optimism, where rational agents learn gradually about the true state of the economy and readjust their expectations [@VanAarle2012]. 

Models with multiple equilibria provide another potential link between confidence and fluctuations in economic activity, where the equilibria may be determined by sentiment [@Taylor2007]. There may be a good equilibrium, with high confidence and a bad equilibrium with low confidence. In this context, confidence is just a prediction of a future outcome, which may become self-fulfilling [@Akerlof2015]. Agents use the available information to make rational predictions and decisions based on these predictions. For instance, a bank run may be triggered if agents start to fear that the bank cannot pay out deposits. This may cause the bank to fail and some agents to lose their deposits. If a run of the banks occurs widely, there may be a general loss of confidence in the financial sector. Even solvent banks could suffer a run that grows into a broad financial panic. This may limit liquidity in the banking system and cause a contraction in credit that harms economic activity. Thus, the level of confidence is a potential variable that can determine which equilibrium occurs. If a crisis of confidence causes a banking panic, the economy may settle in a bad equilibrium. If confidence is high, the economy may settle in a good equilibrium [@Leduc2010].

Broadly speaking, there are two views on the role of confidence in macroeconomics: the so-called "animal spirits" view and the information or "news" view [@Barsky2012]. According to the animal spirits view, psychological factors, or animal spirits, have a causal impact on expectations and the business cycle. This view supposes that an exogenous shift in pessimism, which may be associated with a negative consumption shock, can have a causal effect on overall aggregate demand [@Barsky2012]. In the case of consumer confidence, optimistic income expectations prompt consumers to increase their discretionary expenditures. These expectations depend not only on economic fundamentals, such as income or prices, but also on psychological factors. Psychological factors therefore influence consumers' perceptions of their economic environment. Changes in confidence may become an independent source of economic fluctuations through its impact on decisions [@Mendicino2013]. 

@Blanchard1993, for instance, argued that the cause of the 1990/1991 US recession was a large negative consumption shock, which was associated with a large unpredictable shock to the Michigan consumer confidence index. He interpreted it as an exogenous shift in pessimism following the invasion of Kuwait and the subsequent increase in oil prices, which had a causal effect on overall aggregate demand. According to this view, confidence is an independent causal factor of economic activity [@Carroll1994].

In their book, "*Animal Spirits*", @Akerlof2015 examined the role of animal spirits in economic fluctuations. They defined "animal spirits" as referring to the restless and inconsistent element of the economy, which was related to confidence, fairness, corruption and bad faith, the money illusion and storytelling. @Akerlof2015 argued that agents are not always rational in their decisions. In the face of uncertainty, decisions about the future are based on animal spirits, rather than a weighted average of quantitative benefits and probabilities, as rational theory would dictate. They argued that deteriorating animal spirits were the main reason for the global financial crisis and subsequent recession.

According to the "news" view, any relationship between confidence measures and subsequent real activity means that confidence measures contain fundamental information about the current and future states of the economy, not yet reflected in economic fundamentals [@Barsky2012]. Confidence can proxy for news that agents receive about future productivity not yet summarised by contemporaneous macroeconomic variables, by aggregating information or news from various sources [@Cochrane1994; @Barsky2012]. These indicators reflect agent's expectations about future fundamentals and reflect their overall outlook on the economic conditions. When agents are optimistic, they give positive responses to surveys. Those optimistic expectations are confirmed on average, and real activity eventually increases as predicted by the confidence indicator [@Carroll1994].

While the literature sets out a potential theoretical link between confidence and economic activity, it is not clear if confidence indicators repackage information already contained in other economic variables, or contain useful independent information about the economy. If they contain predictive information, it is not clear if they reflect animal spirits, or aggregated information on agents' expectations of future outcomes not captured by economic data [@Mendicino2013; @Akerlof2015]. The assessments range from the view that confidence measures have an important causal role in the business cycle, to the view that they contain useful predictive information but little causal role, to the view that they have no value, even in forecasting [@INIS2014]. The following section reviews the empirical findings on the role of confidence.

###Empirical Findings
The majority of studies seem to find that confidence measures that confidence indicators are positively related to real economic activity, although the findings have not been conclusive. This may be due to the two main challenges for empirical work on business confidence: to construct proxies for confidence and to measure the causal impact of confidence on real economic activity. 

####Measuring Confidence
Confidence is an elusive concept, which is cannot be observed or measured directly [@Santero1996]. To construct proxies for confidence, analysts typically aggregate responses from business and consumer surveys. These surveys usually contain a small number of qualitative questions, which can be answered quickly by respondents. Indicators are derived from the subjective answers to questions on past, current and future developments. The assumption is that before a specific business activity is implemented (e.g. new production plans, employment, or purchases), some opinion-building has occurred, which may be called "sentiment" or "confidence". The most important advantage of these surveys is that they are available long before official statistics become available. Moreover, they are not subject to revisions and avoid problems with trends and seasonality.   

The most common and widely used method to summarise or aggregate survey responses is to calculate so-called balances. In the context of business tendency surveys, balances are simple averages of survey responses. For most survey questions there are three reply options, e.g. *up*, *the same*, or *down*. Balances are calculated as the difference between the percentage of positive answers and negative answers. Balances are simple to implement and understand and are considered both practical and entirely adequate for cyclical analysis [@OECD2003].[^21]

[^21]: Diffusion indices are a slight variation on balances. In the context of business tendency surveys, they indicate the degree to which the change is diffused throughout the sample. The most common way to calculate a diffusion index consists of taking the percentage of respondents answering positively and adding it to half of the percentage of respondents reporting "unchanged". Thus, diffusion indices are a linear transformation of balances and have the same information content (OECD 2003).

Although balances are by far the most common aggregation method used by statistical agencies and analysts, they do rely on assumptions about the distribution of responses. Namely, that the "unchanged" share is constant over time and that the relationship among positive and negative answers is linear and constant over time. For this reason, various alternatives have been discussed in the literature, including the probabilistic approach, the regression approach, and the latent factor approach [@Nardo2003].[^22] However, these approaches usually require actual quantitative reference series for the relevant variables, which is restrictive in the case of business confidence, where quantitative reference series are unavailable. Moreover, the fact that they are linked to a reference series, implies that these methods can become unreliable when exceptional events have a large impact on the correlation between the survey data and the quantitative reference data [@INIS2014].

[^22]: The probabilistic approach assumes a probability distribution for the variable concerned, and the measure is a function of this specific probability distribution. The regression approach uses the relationship between survey responses of the past and actual values to quantify respondents' expectations about the future. The measures are a function of specific regression models (Nardo 2003). In the latent factor approach the percentages of each response is a function of a common "latent measure" observed by respondent but not by econometricians. 

The evidence suggests that sophisticated methods tend to produce indicators that follow the common cycle, which can be more easily deduced by simple aggregation methods such as balances. For instance, the Italian National Statistical Agency found a very high correlation between balances and more sophisticated indictors when using three-option responses [@OECD2003]. @Driver2004 assessed different ways of aggregating qualitative data from the UK employers' business survey into quantitative indicators for a number of variables. They found that the balance statistic was a satisfactory aggregation method for the survey responses on output, investment, and exports.

Composite confidence indicators are typically derived from multiple questions in sector-specific surveys. The sector indicators are then aggregated to form aggregate composite indicators. As no single cause explains all cyclical fluctuations over the long term, it necessary to have signals for many possible causes of cyclical change, i.e. to use all potentially important information [@VanAarle2012]. Composite indicators, as opposed to answers from a single question, may have fewer false alarms and fewer missed turning points than individual components and tend to have more stable lead-times. They have the capacity to react to various sources of economic fluctuations, while being resilient to fluctuations affecting single components [@ECB2013]. Composite indicators typically include questions on prevailing conditions as well as expectations, although the recent literature suggests a distinction between indicators of current activity and forward-looking indicators [@Bachmann2010]. 

The European Commission builds composite indicators by aggregating the survey responses from 5 sectors, using multiple questions on current conditions and expectations. For instance, the industrial indicator is an average of the balances of questions relating to production expectations, stocks of goods (with inverted sign), and order books, while the retail trade indicator is an average of balances of questions relating to the present and future business situation and stocks (with inverted sign) [@OECD2003]. The aggregate Economic Sentiment Index is a weighted average, using value added shares, of sentiment in the manufacturing, construction, retail, and services sectors, as well as among consumers [@ECB2013].

Composite confidence indicators are now calculated by most countries. A prominent example is the Ifo Business Climate Indicator, which is used as a leading indicator in Germany. It is computed as a geometric mean of the balances referring to the current business situation and the business outlook in the next six months. The results for the manufacturing, construction, wholesale and retail sectors are weighted according to the importance of the industry. Another example is the Italian Economic Sentiment Indicator. It is based on the set of balances from surveys of industry, construction, services and retail trade, which are normalised and weighted with value added shares. Other composite confidence indicators include those published by the University of Michigan for the US, and the Tankan general business climate indicator calculated by the Bank of Japan [@INIS2014].

Various confidence indices have been used in the literature. @Taylor2007 and @Mendicino2013, for instance, used the composite confidence indicators based on the European Commission surveys for a number of European countries. @Bachmann2010 and @Bachmann2013 used the Philadelphia Fed's Business Outlook Survey and the German Ifo Business Climate Survey to calculate indices of current activity, as well as forward-looking indices. @Barsky2012 used the Michigan Survey of Consumers to construct a forward-looking measure of confidence. @Kabundi2004 used a dynamic factor model to extract the common components from the French Statistics Institute's business survey data.

Two indicators of confidence are published in South Africa: the RMB/BER Business Confidence Index (BER BCI) and the South African Chamber of Commerce and Industry Business Confidence Index (SACCI BCI). The BER BCI, discussed in more detail below, is constructed from the BER's quarterly business tendency surveys, which are similar to the business tendency surveys conducted all over the world. The BER BCI is constructed from a specific question that appears in all of the surveys (Q1): *"Are prevailing business conditions: Satisfactory, Unsatisfactory?"* The BCI is the weighted percentage of respondents that rated prevailing business conditions as *"Satisfactory"* and is therefore based on the perceptions of business people [@Kershoff2002]. The survey responses are weighted (except the building survey), and the BER BCI is calculated as the unweighted mean of five sectoral indices (but excludes the services survey). The BER BCI is an index of current economic activity, as opposed to forward-looking expectations, which is independent of external macroeconomic variables [@Pellissier2002].

The SACCI BCI, formerly known as the SACOB BCI, is a composite index of 13 quantitative sub-indices thought to have the greatest influence on the business mood. These include the exchange rate, inflation, the prime rate, retail sales volumes, credit extension, commodity prices, import and export volumes, new vehicle sales, utility services, manufacturing production, building plans passed, and the stock market index. The SACCI BCI is an *ex post* measure of actual activity, which is dependent on external macroeconomic variables. The rationale is that recent business activity is indicative of the degree of business confidence [@SACCI2011]. In this sense the SACCI BCI is a composite measure of economic activity, rather than a confidence indicator in the way it is used in the literature.

In practice, therefore, analysts typically calculate balances to aggregate responses from business and consumer surveys to construct proxies for confidence. They often calculate composite measures based on a set of questions for each sector, including questions of current conditions and expectations. In South Africa there are only two regularly published business confidence indicators: the BER BCI and the SACCI BCI. The SACCI BCI is not a true confidence measure, and the BER BCI is a measure of current conditions, based on a single question, with survey responses weighted in an ad hoc manner. 

One of the primary objectives of this chapter is to explore aggregation methods to try to improve on the existing measures of confidence for South Africa. The chapter calculates composite indicators of business confidence based on the BER business tendency survey microeconomic data. The composite indicators incorporate the survey responses from a number of questions, maintaining a distinction between indicators for current conditions and forward-looking questions. The responses are systematically weighted to produce sectoral and aggregate indicators, which are analysed separately. The indices also incorporate the services sector, which is not currently part of the BER BCI. 

####The Impact of Confidence
The majority of studies seem to find that confidence indicators are positively related to real economic activity, although this does not necessarily imply a causal relationship [@ECB2013]. Confidence indicators have been found to be useful in some cases as leading indicators, as well as for forecasting, even after controlling for other economic variables. Even in cases where the unique information content is limited, the timeliness of survey indicators may make them useful for monitoring developments and for real-time forecasting (nowcasting). 

The empirical literature has often investigated the extent to which confidence indicators contain predictive information over and above economic fundamentals [@INIS2014]. A number of studies have found that forecast accuracy improves with the inclusion of survey-based indicators, although the evidence has not been unanimous [@Strasser2015]. A number of studies have shown that both consumer and business confidence indicators provided valuable information for forecasting real activity, which was not contained in other economic variables [e.g. @Santero1996; @Ludvigson2004; @Kabundi2004; @Parigi2004; @Taylor2007; @Leduc2013; @Mendicino2013; @Martinsen2014; and @Kilic2016]. 

In an influential study, @Barsky2012 found that positive shocks to consumer confidence lead to significant, slow-building, and permanent impulse responses in consumption and income. If confidence contained no news about future fundamentals, and only reflected only animal spirits, one would expect transitory responses. They concluded that consumer confidence was not merely noise, nor simply reflections of information contained in other variables, which supports the "news" view of confidence.

The @ECB2013 found that confidence indicators can play a significant role in predicting recessions. They included the EC consumer confidence index, along with the OECD leading indicator for the euro area in a probit model. This model captured business cycle phases relatively well, with probabilities increasing when recessions occurred. The drawback was that probabilities also increased in some periods without recessions, i.e. there were some false positives.

The forecasting ability of confidence indicators might be offset by other indicators during ordinary times, while increasing notably during unusual events [@INIS2014]. The @ECB2013 found that shocks to confidence played a relatively small role during normal times, but were important during more extreme episodes such as financial crises and recessions. The impact was asymmetric: large decreases in confidence were more important in predicting future changes in consumption than large increases. This pointed to a non-linear and asymmetric relationship between confidence and economic fluctuations. 

Even if confidence indicators are just a synthesis of economic variables and do not carry information over other economic series, they may still be useful for monitoring economic developments and for real-time forecasting of economic activity. This is because they are available long before official quantitative statistics and are subject only to limited revisions [@Santero1996]. In the euro area, for instance, data are released at least 45 days after the reference month (e.g. data for January is only available by mid-March). Business surveys are usually available before the end of the reference month (e.g. the Italian survey data are released about 45 days before the industrial production index). Confidence indicators can provide valuable information on the evolution of the economy over this period, which is one of the reasons why they are popular [@Parigi2004]. In this sense, even if the confidence indicators are coincident indicators of real activity, the fact that they are available much earlier means that they are quasi-leading indicators.

A number of studies have demonstrated that confidence indicators are useful for nowcasting economic activity. @Gayer2014 evaluated the impact of new releases of financial, real and survey data (using the EC surveys) on nowcasting euro area GDP throughout each quarter. They found that survey and real data improved forecast accuracy throughout the entire sequence of nowcasts. Confidence indicators contained informational content even after controlling for timeliness, due to their broad sectoral coverage and forward-looking nature. Similarly, @Matheson2007 found that business survey indicators improved real-time forecasting accuracy. This was not only due to their timeliness, but also to the underlying quality of the data. The results were consistent with the literature showing that survey indicators are not only timely proxies for hard data, but contain complementary information for understanding business cycle developments.

Relatively few studies have analysed confidence indicators in South Africa. @Pellissier2002 examined the ability of the two South African business confidence indicators, the BER BCI and SACCI BCI, as business cycle indicators. The business confidence indicators were highly correlated with each other and had leading indicator properties. The BER BCI seemed to display stable turning point attributes. He argued that both BCIs seemed to exhibit a coincident rather than a leading relationship. More recently, @Laubscher2014 found that the BER BCI was one of the closest predictors of the official reference business cycle turning points and useful as a leading indicator. The BER's BCI is used by the SARB as an official leading indicator of the business cycle [@Venter2005a].

The BER BCI has occasionally been included in larger datasets in forecasting exercises. For instance, @Gupta2010 analysed the impact of monetary policy on house price growth in South Africa using a factor augmented vector autoregression. The models were based on 241 other quarterly series, including real, nominal, financial and intangible variables, such as confidence indices. @Gupta2011 used similar large factor models, with a large cross-section of macroeconomic time series, to forecast per capita growth, inflation, and the interest rate. Confidence indices were also included in the dataset of 267 quarterly series. 

@Kabundi2016 included the BER Consumer Confidence Index (BER CCI) and the SACCI BCI to forecast real GDP growth in South Africa in real time. They argued that the timeliness of the variables was especially important. For example, the BER CCI and the SACCI BCI of the corresponding quarter are published 4 and 2 weeks before the end of the quarter. This implies that soft data can be very useful in forecasting exercises. 

There has been very little analysis of the impact of business confidence on economic activity in the South African context. One of the secondary aims of this chapter is to examine the relationship between business confidence and real activity in South Africa. The chapter tries to establish if there is a significant positive relationship between the indicators and real GDP growth, the timing of this relationship, and if it remains significant after taking other economic variables into account.

##Uncertainty
@Knight1921 defined uncertainty as agents' *"inability to forecast the likelihood of events happening."* Uncertainty refers to a lack of knowledge of the set of possible outcomes and their associated probabilities (e.g. the number of coins ever produced is uncertain), which makes forecasting difficult. According to this definition, uncertainty is distinct from the concept of risk, which refers to a known probability distribution of a set of outcome (e.g. a coin toss). Nevertheless, researchers usually refer to a single concept of uncertainty, which is typically a mixture of uncertainty and risk [@Bloom2014]. 

###Macro Theory and Uncertainty
The theoretical literature emphasises two negative and two positive channels through which uncertainty can influence economic activity. Most of the focus is on "real options" theory, based on @Bernanke1983. Uncertainty may have economic consequences when there is a degree of irreversibility to firms' actions. Firms receive new information over time, reducing uncertainty and increasing their ability to undertake the optimal investment. If the value of time, i.e. the benefit of new information, exceeds the costs of committing to a suboptimal project, it is rational to wait before committing to an investment [@Binding2015]. Because it increases the value of waiting for new information, uncertainty delays the current rate of investment [@Bernanke1983]. Thus, the option value of waiting increases as the uncertainty increases [@Bloom2014]. 

This theory has led to idea of a "wait-and-see" effect [@Bloom2009]. If a firm faces large fixed adjustment costs[^23], higher uncertainty about future demand makes new investments and hiring less attractive. Firms try to minimise the number of times this fixed adjustment cost must be paid. When the future is uncertain, in the sense that demand could be either very high or low, it makes sense to wait until the uncertainty is resolved [@Bachmann2010]. Facing a more uncertain environment, firms delay investment and hiring, i.e. they "wait and see" how the future unfolds, which leads to a decrease in economic activity. As the future unfolds, there is pent-up demand for capital and labour. Firms are closer to their adjustment triggers in subsequent periods, leading to a rebound and even overshoot in economic activity. Thus, the initial decrease is followed by a swift recovery and overshoot in economic activity [@Bachmann2013]. 

[^23]: For capital, these costs can be both physical (equipment may be damaged in installation and removal) and financial (discounts for used goods). For labour, adjustment costs include recruitment, search frictions, training, and severance pay.

Uncertainty can also negatively affect economic activity through risk aversion and risk premia. If investors are risk averse, higher uncertainty increases risk premia, by increasing the probability of default of lenders [@Redl2015]. The accompanying increase in borrowing costs can reduce growth, as highlighted in studies of uncertainty under financial constraints (summarised in @Bloom2014 and @Bachmann2013). In models where agents have pessimistic beliefs, and uncertainty about the future is too high to form a probability distribution, agents act as if the worst outcomes will occur (so-called ambiguity aversion). As uncertainty increases and the range of possible outcomes increases, the worst possible outcome becomes worse, leading agents to decrease investment and hiring. In contrast, if agents are optimistic (they assume the best case), uncertainty can have a positive impact on activity [@Bloom2014]. 

@Bloom2014 also refers to two other channels through which uncertainty can have a positive effect on economic activity. The "growth options" argument is based on the idea that uncertainty can create call option effects. Uncertainty may increase investment if the size of the potential prize increases. This is due to the potential for an increase in upside gains, while the downside loss is limited to initial sunk costs, leading to an increase in expected investment returns [@Redl2015]. 

The Oi-Hartman-Abel effect highlights the possibility that firms may be risk-loving if they can expand to exploit good outcomes and contract to insure against bad outcomes. For example, if a firm can easily double production if prices increase, and halve production is prices decrease, it should desire a mean-preserving increase in uncertainty. This is because it receives 200% in good times and 50% during bad times. In effect, the firm can partly insure against bad outcomes by contracting and can exploit good outcomes by expanding. For this mechanism to work, firms need to be able to expand or contract easily in response to good or bad outcomes. @Bloom2014 argues that this effect is not very strong in the short run because of adjustment costs, but may be more powerful in the medium to long run.

@Bonciani2015 argue that in a general equilibrium framework the aforementioned effects may or may not be completely offset. In a New Keynesian Model, for instance, the monetary authority can partially offset the negative effects of uncertainty by reducing the nominal interest rate. They argue that this is the most important reason why many papers do not find a strong effect. However, when the monetary authority is constrained by the zero lower bound, or when there is imperfect pass-through, the effects of uncertainty become more significant, as the central bank cannot perfectly respond to the shock. 

The theoretical literature sets out potential channels through which uncertainty may have a positive or negative impact on economic activity. The majority of studies seem to find a significant negative relationship between proxies of uncertainty and economic activity. The following section reviews the empirical findings.

###Empirical Findings
The recent surge in research on uncertainty has been driven by the idea that uncertainty increased during the financial crisis and its likely role in shaping the Great Recession. In addition, the availability of empirical proxies for uncertainty has increased, along with the ability to include uncertainty in a wide range of models [@Bloom2014]. There are two main challenges when it comes to empirical work on uncertainty: how to construct proxies for uncertainty and how to distinguish a separate causal impact of uncertainty. 

####Measuring Uncertainty
It is unsurprising that there is no perfect measure of uncertainty, given its broad definition and the potential influence of a broad range of factors. The literature has proposed a wide range of proxies for uncertainty. These proxies can be grouped into five major categories, depending on the nature of the data used for their construction. All proxies for uncertainty measure a specific type of uncertainty and have strengths and weaknesses. 

The first category uses financial data, with the majority of studies using as proxies the implied or realised volatility in the stock market, GDP, bond yields or exchange rates. The rationale is that more volatile series are more difficult to forecast, and are associated with a greater the degree of uncertainty [@Bloom2014]. @Bloom2009, @Baker2013, @Bonciani2015 and @Leduc2015, for instance, used stock market volatility. A popular proxy is the Chicago Board Options Exchange Market Volatility Index, which focuses on the implied volatility of the S&P 500 index. It reflects the dispersion of market participants' estimates of future stock prices, as measured by the implied dispersion across all options with a given time to maturity. The most frequent criticism is that developments on stock markets may only partly reflect developments in the real economy [@Girardi2015].

The second category uses new information in the construction of uncertainty indicators. The most prominent examples are proxies based on references to "uncertainty" in the media. @Baker2015, for instance, developed economic policy uncertainty indices based on the frequency of references to policy uncertainty in newspapers. This was combined with disagreement among forecasters on future government purchases and inflation, and the number of tax code provisions about to expire. One criticism is that the selection of newspapers and search terms entails a certain degree of subjectivity [@Girardi2015].

The third category is derived from the disagreement of professional forecasters. The rationale is that a larger dispersion of opinions about the future indicate a higher degree of uncertainty. @Popescu2010, for instance, used a proxy for uncertainty based on the dispersion of professional forecasts of consumption, industrial production, investment, output, prices and interest rates in the German economy. The downside is that the factors influencing a limited set of professional forecasters might differ from those influencing producers and consumers [@Girardi2015].

The fourth category is the dispersion of responses from business and consumer surveys. For instance, @Bachmann2010 and @Bachmann2013 used the dispersion of business survey responses, as well as the dispersion in individual forecast errors to construct proxies for the US and Germany. @Arslan2011 used a similar measure of squared expectations errors to construct uncertainty indicators for Turkey. @Girardi2015 derived similar survey-based indicators, but with the difference that they were available in real-time, and used aggregated responses on all forward-looking questions. @Leduc2015 also used a survey-based proxy for uncertainty, measured as the fraction of respondents that listed uncertainty as a factor limiting their spending plans. Survey-based measures have the advantage that they are derived from opinions of key economic agents, as opposed to outside observers (e.g. professional forecasters) or the choices of investors on financial markets [@Girardi2015]. 

A fifth category was introduced by @Jurado2015. They argued that indicators of uncertainty should reflect the common variation across a vast array of variables, and that the forecastable component of each series should be removed when calculating volatility. They constructed new indicators using a large dataset of macroeconomic and financial indicators, as well as firm-level data. They extracted common factors, used them to predict industrial production, and subsequently calculated the forecast errors. Increases in the volatility of forecast errors were interpreted as increases in uncertainty. The disadvantage is that the indicator is an *ex post* measure, which requires the actual outcome of the forecasted time series before computing the indicator [@Girardi2015].

A few studies have constructed proxies for uncertainty in the South African context. @Redl2015 constructed an index of uncertainty for South Africa, based on disagreement among professional forecasters, the number of newspaper articles that mentioned economic uncertainty in South Africa, and references to uncertainty in the SARB's Quarterly Review. 

@Hlatshwayo2016 created a measure South African economic policy uncertainty, by looking at "news chatter" in the media, similar to the method used in @Baker2015. They created both economic policy and political uncertainty indices at the sectoral and aggregate level, by counting the number of articles that matched specific search algorithms. Aggregate economic uncertainty, for example, was measured by counting articles containing 3 mentions of words related to policy, economics, and uncertainty (i.e. one mention of each area) within 10 words of "South Africa". The absolute counts were normalised and the indices were standardised. @McClean2015 created a similar news-based index for aggregate South African policy uncertainty. He found a moderate correlation between this index and the SAVI and SA government bond yields.

@Pellissier2007 used the BER's manufacturing surveys to construct a measure of uncertainty. "Volatility" in survey expectations was derived from the (unweighted) percentage of survey respondents changing their expectation between survey periods. "Realization" of survey expectations was derived from changes in survey expectations in period $t-1$, compared to survey realisations in period $t$. They found a negative relationship between Volatility and Realization for responses relating to business conditions, production, sales, fixed investment and prices. @Hart2015 also used the BER's manufacturing sector survey to create dispersion measures of uncertainty, similar to the method used in @Bachmann2010.

Recently, @NWU2016 created a policy uncertainty index for South Africa. The index has three components: the frequency of references to economic policy uncertainty in leading publications; expert opinions drawn from leading private sector economists; and responses from the BER manufacturing survey on whether the political climate is a constraint to doing business. This index is only available from July 2015.

None of these studies has fully exploited the information contained in the BER business tendency surveys. One of the primary objectives of this chapter is to explore aggregation methods to try to improve on the existing measures of uncertainty for South Africa, using the microeconomic data from BER business tendency surveys. Survey-based measures have the advantage that they are derived from opinions of key economic agents, which may help to measure business uncertainty directly. The composite indicators incorporate the survey responses from a number of questions, and are systematically weighted to produce sectoral and aggregate indicators, which are analysed separately. In addition, the chapter creates a composite overall measure of uncertainty, which combines the survey-based indicators with financial market and economic policy uncertainty. 

####The Impact of Uncertainty
The majority of studies seem to find a negative relationship between uncertainty proxies and economic activity, although this does not necessarily imply causality. The literature has taken three approaches to identify the impact of uncertainty on activity [@Bloom2014]. The first approach uses structural models to identify the potential impact of uncertainty shocks. A second approach relies on timing, typically in a VAR framework, by estimating the movements in economic activity that follow changes in uncertainty. A third approach exploits natural experiments such as exchange rate movements, disasters, and political coups.

A number of papers have used structural models (i.e. DSGE models) to investigate potential mechanisms for uncertainty to influence economic activity. Empirical VAR models are then used to confirm the theoretical model predictions. In a seminal paper, @Bloom2009 used a structural model to simulate the impact of an uncertainty shock, which produced the rapid decrease and subsequent rebound in aggregate output and employment predicted by the "wait-and-see" effect. This simulated impact was compared to VAR estimations on actual data, using stock market volatility as a proxy for uncertainty. The results matched in both magnitude and timing, with a shock to uncertainty generating a decrease and then an overshoot in employment and production. 

@Bloom2007 developed a model of the firm's investment decisions to show that, with partial irreversibility, the impact of a firm-level demand shock on investment tended to be weaker for firms that were subject to higher uncertainty. Their empirical model then found evidence of more cautious investment behaviour for firms subject to higher uncertainty. @Leduc2015 used a structural model with nominal rigidities and search frictions to show the mechanism through which uncertainty could produce large economic effects. Their empirical model found that uncertainty shocks resembled aggregate demand shocks, reducing investment, short-term interest rates and inflation, and increasing credit spreads and unemployment. @Bonciani2015 investigated the impact of uncertainty under financial frictions with a structural model. They found that higher uncertainty reduced activity, and that the impact was potentially larger during a recession.

A number of studies have investigated the timing of the relationship between uncertainty and economic activity in a VAR framework. In general the results are similar to @Bloom2009, with a positive shock to uncertainty followed by a significant decrease in output, investment and employment [e.g. @Arslan2011; @Baker2015; @Girardi2015; and @Jurado2015].

@Bachmann2010 found that innovations to their survey-based uncertainty indicators had prolonged negative effects on economic activity. The long-run effects of uncertainty shocks were similar to the long-run effects of negative confidence shocks. However, when uncertainty was restricted to have no long-run impact, which is what the "wait-and-see" effect would predict, uncertainty had no significant impact on activity. They argued that uncertainty could be seen as a symptom of poor economic times rather than a causal mechanism. In a follow-up study, @Bachmann2013 found that positive shocks to uncertainty were associated with a significant decrease in production and employment in both Germany and the US. German production declined and rebounded relatively quickly following an increase in uncertainty, while the response of US output was protracted, with limited evidence of a rebound. The US results suggested that some of the other mechanisms proposed in the literature, such as financial frictions may be important.

A number of studies have investigated the interaction of uncertainty and financial frictions. @Popescu2010 argued that once a measure of financial stress is included in the regressions, the independent role of uncertainty shocks becomes minimal. They found that the real effects of financial risk premia were larger and more persistent that uncertainty effects. @Caldara2016 found that uncertainty shocks had a significant negative impact on both financial conditions and real economic activity. Their results suggested that increases in uncertainty associated with tighter financial conditions had a particularly large negative effect on real economic activity.

Other studies have exploited natural experiments such as disasters, political coups, or exchange rate movements. For instance, @Baker2013 used natural disasters, terrorist attacks and unexpected political shocks as instruments for the usual stock market proxies of uncertainty. They found that uncertainty shocks accounted for at least half of the variation in GDP growth. @Binding2015 showed how different uncertainty indicators reacted to the unexpected policy change when the Swiss National Bank decided to return to a floating exchange rate regime in 2015. Firms affected by this exogenous increase in uncertainty decreased their planned investment, relative to firms that were unaffected. However, once they controlled for the degree of irreversibility of firm investment, the relationships were no longer significant. 

There is relatively little evidence on the impact of uncertainty in South Africa. Developing countries tend to experience higher uncertainty because they tend to have less-diversified economies, which are more exposed to price and output fluctuations of volatile goods such as commodities [@Bloom2014]. Developing countries tend to have more political shocks, are more susceptible to natural disasters, and often have less effective stabilisation policies. It is possible that fluctuations in uncertainty are drivers of business cycles in developing countries, given that they experience higher levels of uncertainty.

@Redl2015 argued that analysing uncertainty in developing countries could help to distinguish between the effects of financial and uncertainty shocks. During the Great Recession many developing countries experienced high uncertainty, while not undergoing the same levels of financial stress as developed countries. He found an increase in uncertainty was associated with a subsequent decrease in output, investment, employment, and asset prices. The results remained after the inclusion of consumer confidence and credit spreads as a measure of financial stress, although the sizes of the impact was moderated. 

@Hlatshwayo2016 explored the role of policy uncertainty in reducing the responsiveness of exports to relative price changes, through the wait-and-see effect. They found that increased policy uncertainty reduced the responsiveness of exports to the real effective exchange rate and had short and long-run effects on export performance. A measure of competitiveness that adjusted for uncertainty and supply-side constraints outperformed the real effective exchange rate in tracking export performance.

@Hart2015 investigated the relationship between sentiment and economy activity in the South African manufacturing sector from 2001Q2 to 2014Q2. The study was closely based on @Bachmann2010, which also measured uncertainty in a manufacturing sector using business survey data. A VAR framework was used to estimate the impact of confidence and uncertainty on investment production, and employment in the South African manufacturing sector. None of the uncertainty measures were found to be significant, probably due to the limited sample period. 

There has been very little analysis of the impact of business uncertainty on real economic activity in the South African context. One of the secondary aims of this chapter is to examine the relationship between uncertainty and real activity in South Africa, using standard agnostic econometric methods (VARs). The chapter tries to establish if there is a significant negative relationship between uncertainty and real GDP growth, and if it remains significant after controlling for other economic variables. The following section discusses the BER business tendency surveys used to create the indicators.

##Data: Business Tendency Surveys
Business tendency surveys are conducted to obtain qualitative information that is useful in monitoring the current business situation and forecasting developments in the business cycle. This is reflected in the extensive use of confidence measures as leading indicators of the business cycle [@OECD2003]. Qualitative surveys can often be completed more easily and quickly than quantitative surveys. The results can be published much sooner than official statistics, which are often released with a significant delay by statistical agencies. Survey data have the advantage of focusing on the assessments and expectations of economic developments by relevant economic decision-makers. Variables related to expectations may reflect cyclical changes earlier than corresponding quantitative statistical series (i.e. expectations lead to plans that are implemented and will then be picked up in quantitative statistics). 

###The BER Business Tendency Surveys
```{r loaddata, echo=FALSE, results='hide', message=FALSE, warning=FALSE, cache = TRUE}
##===========================##
##------ SENTIMENT ----------##
##===========================##
setwd("C:\\Users\\Laurie\\OneDrive\\Documents\\BING\\BER Confidence Surveys\\Sentiment")

suppressMessages(library(ggplot2))
suppressMessages(library(plyr))
suppressMessages(library(dplyr))
suppressMessages(library(reshape2))
suppressMessages(library(stargazer))
suppressMessages(library(xtable))
suppressMessages(library(scales))
suppressMessages(library(quantmod))
suppressMessages(library(vars))
suppressMessages(library(tseries))
suppressMessages(library(urca))

GDPdata <- read.csv("GDP Data.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE)
GDPdata$Date <- as.Date(GDPdata$Date, format = "%Y/%m/%d")

datums <- read.csv("dates2.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE)
datums$Datum <- as.Date(datums$Datum, format = "%Y/%m/%d")

##For Grpahing Business cycles
recessions.df = read.table(textConnection(
    "Peak, Trough
    1990-12-31, 1993-05-30
    1996-11-30, 1999-08-31
    2007-11-30, 2009-08-31
    2013-11-30, 2016-12-31"), sep=',',
    colClasses=c('Date', 'Date'), header=TRUE)

realGDP <- read.csv("RealGDP.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE)
realGDP$Date <- as.Date(realGDP$Date, format = "%Y/%m/%d")

GDPgrowth4 <- as.data.frame(sapply(log(realGDP[,-1]), diff, lag =4))
GDPgrowth1 <- as.data.frame(sapply(log(realGDP[,-1]), diff, lag =1))


##====================================##
## READING IN THE DATA ##
##====================================##
BER.M <- rbind.fill(read.csv("Manufacturing.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE),
                    read.csv("Manufacturing_pre2001.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE))
BER.M <- BER.M[,1:62]
colnames(BER.M)[1:7] <- c("region","id","sector","weight","turnover","factor","surveyQ")

##===============================##
BER.B <- read.csv("Building_corrected.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE)
BER.B <- BER.B[!(BER.B$surveyQ %in% c("2015Q4","2016Q1","2016Q2","2016Q3")),1:21]

##============================##
BER.R <- read.csv("Retail.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE)
BER.W <- read.csv("Wholesale.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE)
BER.T <- rbind(BER.R,BER.W)
BER.T <- rbind.fill(BER.T,read.csv("Trade_pre2001.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE))
BER.T <- BER.T[,1:21]
colnames(BER.T)[1:6] <- c("region","id","sector","weight","factor","surveyQ")
BER.T$factor <- as.numeric(as.character(BER.T$factor))

##=====================================##
BER.V <- rbind.fill(read.csv("Motor.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE),
                    read.csv("Motor_pre2001.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE))
BER.V <- BER.V[,1:28]
colnames(BER.V)[1:6] <- c("region","id","sector","weight","factor","surveyQ")

##===============================##
BER.S <- read.csv("Services.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE)
colnames(BER.S)[1:6] <- c("region","id","sector","weight","factor","surveyQ")

#==================
#AGGREGATING
#==================
#Create an unweighted stacked version of all the surveys
#Match the same or similar questions from the different surveys (see survey question examples)
#Create NAs for missing questions
tempBER.M <- cbind(BER.M[,c("id","sector","weight","factor","surveyQ","Q20","Q7A","Q7P","Q1A","Q1P","Q8A","Q8P",            "Q4A","Q4P")],"Manufacturing")
colnames(tempBER.M) <-    c("id","sector","weight","factor","surveyQ", "Q1","Q2A","Q2P","Q3A","Q3P","Q4A","Q4P",            "Q6A","Q6P",  "Sector")
tempBER.M[,c("Q5A","Q5P")] <- NA
tempBER.B <- cbind(BER.B[,c("id","sector","weight","factor","surveyQ", "Q1","Q2A","Q2P","Q3A","Q3P","Q4A","Q4P","Q5A","Q5P")],            "Construction")
colnames(tempBER.B) <-    c("id","sector","weight","factor","surveyQ", "Q1","Q2A","Q2P","Q3A","Q3P","Q4A","Q4P","Q5A","Q5P",              "Sector")
tempBER.B[,c("Q6A","Q6P")] <- NA
tempBER.T <- cbind(BER.T[,c("id","sector","weight","factor","surveyQ", "Q1","Q2A","Q2P","Q3A","Q3P","Q5A","Q5P","Q8",       "Q4A","Q4P")],"Trade")
colnames(tempBER.T) <-    c("id","sector","weight","factor","surveyQ", "Q1","Q2A","Q2P","Q3A","Q3P","Q4A","Q4P","Q5A",      "Q6A","Q6P"  ,"Sector")
tempBER.T[,c("Q5P","Q6A","Q6P")] <- NA
tempBER.V <- cbind(BER.V[,c("id","sector","weight","factor","surveyQ", "Q1","Q2A","Q2P","Q3A","Q3P",                        "Q4A","Q4P")],"Trade")
colnames(tempBER.V) <-    c("id","sector","weight","factor","surveyQ", "Q1","Q2A","Q2P","Q3A","Q3P",                        "Q6A","Q6P"  ,"Sector")
tempBER.V[,c("Q4A","Q4P","Q5A","Q5P")] <- NA
tempBER.S <- cbind(BER.S[,c("id","sector","weight","factor","surveyQ", "Q1","Q2A","Q2P","Q3A","Q3P","Q4A","Q4P","Q5A","Q5P")],            "Services")
colnames(tempBER.S) <-    c("id","sector","weight","factor","surveyQ", "Q1","Q2A","Q2P","Q3A","Q3P","Q4A","Q4P","Q5A","Q5P",              "Sector")
tempBER.S[,c("Q6A","Q6P")] <- NA

BER <- tempBER.M
BER <- rbind(BER,tempBER.B,tempBER.T,tempBER.V,tempBER.S)
BER <- BER[,c(15,1:12,16,17,13,14)]
rm(tempBER.M,tempBER.B,tempBER.T,tempBER.V,tempBER.S)
rm(BER.M,BER.B,BER.T,BER.V,BER.S,BER.R,BER.W)

#Clean data
BER$surveyQ <- toupper(BER$surveyQ)
BER$sector <- factor(BER$sector) #could include labels
BER$id <- factor(BER$id)
BER$surveyQ <- factor(BER$surveyQ)

# replace 1,2,3 (Up, Same, Down) responses with 1,0,-1
for(i in 7:ncol(BER)) {
    BER[,i] <- replace(BER[,i], BER[,i]==2, 0)
    BER[,i] <- replace(BER[,i], BER[,i]==3,-1)
}
BER$Q1 <- replace(BER$Q1, BER$Q1==0,-1) # replace 0 (Unsatisfactory) responses with -1
```

The BER, a research institute attached to Stellenbosch University, has been conducting business tendency surveys in South Africa since March 1954. The BER's quarterly business surveys are similar to the business tendency surveys conducted all over the world, including the European Commission business tendency surveys, the German Ifo Business Climate Survey, the Federal Reserve Bank of Philadelphia's Business Outlook Survey, and the Bank of Japan's Tankan survey [@OECD2003].

During the last month of each quarter questionnaires are sent to 1,000 firms in each of the manufacturing and services sectors and 1,400 firms in each of the construction and trade sectors (i.e. retail, wholesale and motor vehicles). The questionnaires are completed by senior executives of the firms. The questions have remained largely unchanged since inception, and include questions on current and expected future developments regarding, among others, sales, orders, inventories, prices, employment,  and constraints For the most part the survey answers fall into three categories: "up", "the same" or "down". 

Table 3.1 reports the details of the survey data. The sample runs from 1992Q1 to 2015Q3, although the survey of the services sector only started in 2005. Figure 3.1 illustrates the number of respondents over time per sector. Around 1,000 completed questionnaires are received every quarter, leading to an overall sample size of 106,255. All of the surveys have a few missing quarters, when the microeconomic data was lost. The overall panel sizes and response rates have remained relatively stable over time, although the response rates are relatively low by international standards [@Kershoff2015].

```{r table3.1, echo=FALSE, results='asis', warning=FALSE, message=FALSE, cache = TRUE}
tafel <- aggregate(BER$id, by=list(BER$surveyQ,BER$Sector), FUN = length)
tafel <- cbind(obs=aggregate(tafel$x, by=list(tafel$Group.2), FUN = sum ),ave=aggregate(tafel$x, by=list(tafel$Group.2), FUN = mean ))[,-3]
tafel$obs.Group.1 <- as.character(tafel$obs.Group.1)
tafel$Resp <- tafel$ave.x/c(1000,1400,1400,1000)
tafel$Sample <- c("1992Q1-2015Q3","1993Q2-2015Q3","1992Q2-2015Q3","2005Q2-2015Q3") 
tafel$Missing <- c("1997Q4,2000Q1,2005Q4","1993Q4,1998Q3,2000Q2,2005Q4","1992Q4,1993Q3,2005Q4","2005Q4") 
tafel <- tafel[,c(1,5,2:4,6)]
tafel <- rbind(tafel,c("Total","1992Q1-2015Q3",nrow(BER),mean(aggregate(BER$id, by=list(BER$surveyQ),FUN = length)[,2]),
                       mean(aggregate(BER$id, by=list(BER$surveyQ), FUN = length)[,2])/4800,"2005Q4"))
tafel[, c(4:5)] <- sapply(tafel[, c(4:5)], as.numeric)
colnames(tafel) <- c("Sector","Sample","Total Obs","Obs/Quarter", "Response Rate","Missing Quarters")     
xt <- xtable(tafel, caption="Sample Characteristics", digits=c(2), align= c('r', "p{3cm}", rep('r',5) ) )
print(xt, "latex",comment=FALSE, caption.placement = getOption("xtable.caption.placement", "top"), scalebox = 0.8,
      include.rownames=FALSE)
```

```{r figure3.1, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="The number of respondents over time per sector"}
BERplot <- aggregate(BER$id, by=list(BER$surveyQ,BER$Sector), FUN = length)
BERplot$Group.1 <- as.Date(as.yearqtr(BERplot$Group.1, format = "%YQ%q"), frac = 1)
g <- ggplot(BERplot, aes(x=Group.1, y=x,fill=Group.2))
g <- g + geom_bar(stat="identity")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + scale_fill_discrete(name="Sector")
g <- g + scale_y_continuous(labels=comma)
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g <- g + ylab("Number of Respondents")
g <- g + xlab("Date")
g
```

The sample of firms remains relatively stable from one survey to the next, effectively creating a panel. The panel is partly fixed and partly rotating, as inactive firms that fail to respond for a period of two years are removed and replaced with new firms. The fixed part reflects the opinions of the same firms over time, which ensures that the results remain comparable between surveys. The results are more likely to reflect changes in the variables under consideration, than changes in the sample from the one survey to the next [@Kershoff2002]. 

Stratified deliberate sampling is used to design the BER's survey panels, which the international norm. Participants are selected to be representative of particular sectors, regions and firm sizes. The respondents are reviewed periodically to ensure reasonable representation of the population universe. The exact number of firms in the universe is unknown to the BER as censuses of the business sector in South Africa are not conducted regularly [@Kershoff2002]. Practical experience has shown that non-random samples can give acceptable results in conducting these types of surveys [@OECD2003]. 

The BER makes no provision for firms that were not selected or did not respond during sampling, implicitly assuming that the non-participating or non-responding firms have the same distribution as the responding firms for the period. This agrees with the @OECD2003's suggested "missing at random" assumption. @Kershoff2015 argues that this is a reasonable assumption, given that the responses cannot vary infinitely and the same factors influence firms in the same sector. He found evidence for this assumption when the inclusion of latecomers had almost no effect on the volatility and tracking record of the results, even at higher levels of disaggregation.[^24]

[^24]: The BER does not adjust individual weights for changes in the response pattern. No calibration or post-stratification is carried out to correct the estimated value. Missing items (specific questions) and missing responses (questionnaires) are not imputed and the results are not revised to provide for questionnaires received after the results have been processed (Kershoff 2015).

Panel sizes and response rates determine the representativeness of the sample. In order to be representative, panels have to include a minimum number of participants, which depends on the level of aggregation and the size of the population universe. The results often remain valid even if the sample size is small and response rate relatively low. A rule of thumb is that around 30 respondents are sufficient to obtain an acceptable level of precision for each stratum [@OECD2003]. This is because the variance of responses for ordinal-scaled data based on a stable panel are lower than quantitative data derived from independent surveys. Representativeness therefore has a smaller impact on qualitative survey results than on quantitative surveys results. Moreover, certain activities are dominated by a few large firms. A panel that is not fully representative will probably produce similar results to a fully representative one [@Kershoff2002]. 

The sample sizes illustrated in Figure 3.1 therefore seem adequate to uncover trends in the data. @Kershoff2002 found that the degree of representation of the BER's construction and trade panels was adequate reflections of the universe, taking response rates into account and comparing the composition of the survey panels with census and other official data. However, the number of participants per sector was too low to consider subsectors or provinces as sub-panels. The survey responses are therefore not disaggregated further into subsectors below.

###The BER Business Confidence Indicator
The BER uses these business tendency surveys to construct its business confidence indicator. The BER BCI has proved useful as a leading indicator of economic growth and the South African business cycle. It is used as one of twelve leading indicator series by the SARB to date official turning points in the business cycle. @Laubscher2014 also found that it can improve estimates of cyclical turning points. This is particularly useful in view of the early availability of the index. The BER index results for a particular quarter are available approximately two months before the official GDP estimates [@Kershoff2000]. 

In calculating the business confidence indicator the most important issues are which survey questions to use and the weightings applied to the responses. The BER BCI is constructed from a specific question that appears in all of the surveys (Q1): *"Are prevailing business conditions: Satisfactory, Unsatisfactory?"* The BCI is the weighted percentage of respondents that rated prevailing business conditions as *"Satisfactory"* in a particular sector. The BCI is therefore a rating of business conditions at a specific point in time.

According to @Kershoff2000 there are two reasons for the use of this one question to construct the confidence indicator. Firstly, it is reasonable to assume that respondents who are satisfied with business conditions will have more confidence than those experiencing unsatisfactory conditions. Secondly, respondents take a variety of factors into account when rating prevailing business conditions, which solves the problem of weighting different factors [@Kershoff2000]. The @OECD2003 argues that responses on general business conditions are usually based on a combination of factors, such as order book appraisals, expectations of interest rates, exchange rates and political developments.

In line with the international best practice, all the survey responses are weighted (except for the building survey). Each response is multiplied by a factor, which is calculated as the product of a firm size weight and a subsector size weight (except for the motor trade, where there are no subsectors). Each firm receives a weighting in relation to turnover, or the size of workforce in the case of manufacturing.[^25] The subsector size weights are based on the composition of production or sales in each subsector, as calculated by StatsSA. The BER does not apply sample weights, as it does not have access to the National Business Register and cannot calculate selection probabilities.[^26] Responses are weighted by firm size and sector weights to obtain five sectoral indices: manufacturing, building contractors (other building subsectors are omitted), retailers, wholesalers and new vehicle dealers (used vehicles and spare parts are omitted). The BCI is calculated as the unweighted mean of the 5 sectoral indices (services are excluded altogether).

[^25]: Unlike quantitative surveys, where weighting is usually inherent in the variables, weighting is necessary for qualitative surveys, because the variables typically collected do not inherently represent the size of a business. The size weights are necessary because the economic significance of the responses are should reflect the size of the firm (INIS 2014). 

[^26]: The BER does not apply sample weights (i.e. the inverse of the probability of selection). This assumes that the probability of selection is the same for all units, which would be the case if firms where selected randomly (OECD 2003).

The BER BCI is a measure of current conditions, based on a single question, with survey responses weighted in an ad hoc manner. The business surveys contain a number of questions, all of which potentially have an impact on business confidence. A composite indicator can be calculated by combining the responses to a number of questions, which is often used internationally [@ECB2013]. Moreover, the BER BCI reflects confidence in current conditions (activity) rather than forward-looking confidence. As the surveys contain questions on expectations, forward-looking responses may also provide valuable information. This chapter aims to build on the BER BCI by calculating composite indicators of current and forward-looking business confidence, which are systematically weighted, and calculated at sectoral level and in the aggregate. In addition, the BER business tendency surveys are uniquely suited to obtain measures of uncertainty. This chapter aims to also construct composite forward-looking indicators of uncertainty, which are systematically weighted, at sectoral and aggregate level. The following section sets out the methodology for constructing these indicators of sentiment.

##Methodology
This section sets out the methodology for calculating the sentiment indicators based on the microdata from the BER business tendency surveys. Indicators of sentiment are usually constructed from the first and second moments of responses to business tendency survey questions. Survey-based measures have the advantage that they are derived from the opinions of key economic agents. 

###Confidence
The BER business surveys contain a number of questions that may be useful in gauging business sentiment in South Africa. These include questions on general business conditions, production, orders placed, employment, and profitability. Most international institutions calculate composite indicators by combining the responses to a number of questions [@ECB2013]. Composite indicators have the capacity to react to various sources of economic fluctuations, while being resilient to fluctuations affecting single components. They may therefore exhibit fewer false alarms and fewer missed turning points than indicators based on a single question. 

This chapter therefore combines the responses to a number of questions to calculate composite indicators. For consistency, the composite indicators are derived from questions that are present in most of the sectoral business surveys. Table 3.2 reports the questions included in each of the sectoral surveys. These questions cover 6 types of variables, namely business conditions, activity (production or sales),[^27] orders placed, employment, and profitability. Not all of the variables are covered in all the surveys. 

[^27]: The wording of the questions are adopted to the characteristics of each sector (Kershoff 2015). Activity is referred to as the "volume of production" in the manufacturing survey, "the volume of building activity" in the construction survey, "the volume of sales" in the trade surveys, and "the volume of business" in the services survey.

\begin{table}[]
\centering
\caption{Survey Questions used by Sector}
\label{my-label}
\begin{tabular}{|l|r|r|r|r|}
\hline
\textbf{Survey Question} & \textbf{Manufacturing} & \textbf{Construction} & \textbf{Trade} & \multicolumn{1}{l|}{\textbf{Services}} \\ \hline
Business Conditions      & X                      & X                     & X              & X                                      \\ \hline
Activity                 & X                      & X                     & X              & X                                      \\ \hline
Employment               & X                      & X                     & X              & X                                      \\ \hline
Profitability            &                        & X                     & X              & X                                      \\ \hline
Orders Placed            & X                      &                       & X              &                                        \\ \hline
\end{tabular}
\end{table}

The recent literature suggests a distinction between indicators of current activity and forward-looking indicators [@Bachmann2010]. Both the Conference Board and the University of Michigan report two component consumer confidence indices: a current conditions component and an expectations component [@Ludvigson2004]. Formally, one can define a $k$-period-ahead expectations measure of activity $(C_t^k)$ at time $t$ as: $C _t^k = E_tf(\Delta^hY_{t+k})$, where $Y_{t+k}$ is a measure of real activity (usually output) at time $t+k$ and $\Delta^hY_{t+k} = Y_{t+k} - Y_{t+k-h}$. A common definition of $f(\Delta^hY_{t+k})$ relies on an up, down, or unchanged classification: 
$$ f(\Delta^hY_{t+k}) = \begin{cases} -1,& \text{if } \Delta^hY_{t+k} < 0\\ 0,& \text{if } \Delta^hY_{t+k} = 0\\ 1,& \text{if } \Delta^hY_{t+k} > 0\\ \end{cases} $$

An alternative is to use a binary classification (e.g. satisfactory or unsatisfactory): $$ f(\Delta^hY_{t+k}) = \begin{cases} 1,& \text{if } \Delta^hY_{t+k} \geq a\\ 0,& \text{if } \Delta^hY_{t+k} < a\\ \end{cases} $$ where $a$ is determined by the preferences of the agent. The recent literature terms $C_t^k$ a measure of "activity" when $k=0$ and a measure of "confidence" when $k>0$. This chapter makes a distinction between indicators of current conditions (activity) and for forward-looking conditions (confidence). 

The BER business tendency surveys make this distinction possible by asking for separate responses relating to current and expected future conditions. The questions on current conditions all have the follow format (e.g. Q2A): *"[Estimated development in current quarter] Compared with the same quarter of a year ago, are General Business Conditions: Better, the Same, or Poorer?"* In other words, it asks whether the factor under consideration in time $t$ is better, the same, or poorer, compared to $t-4$. The forward-looking questions all have the following format (e.g. Q2P): *"[Expected development in next quarter] Compared with the same quarter of a year ago, will General Business Conditions be: Better, the Same, or Poorer?"* In other words, it asks whether the factor under consideration in time $t+1$ is expected to be better, the same, or poorer, compared to $t-3$. Responses are relative to the same quarter of the previous year, which corresponds to year-on-year growth rates. The cyclical profiles are therefore easier to detect because they contain no trend and are usually considered a growth cycle [@OECD2003]. It also implies that seasonal adjustment is not required.[^28]

[^28]: A common challenge is that respondents may not use the correct reference period when answering the question (OECD 2003). It is possible that this is the case in the BER survey responses. For example, answers to the forward-looking questions may compare the next quarter t+1 to period t, instead of period t-3. 

As discussed above, confidence indicators are almost always based on the balance statistics. Individual answers are aggregated by subtracting the share of negative answers from the share of positive answers. This presents a single summary figure of responses to each question [@Santero1996]. It is the cross-sectional average of survey responses if the standard quantification system is used: "up" is quantified by +1, "the same" by 0 and "down" by -1. Current Activity and forward-looking Confidence may be defined as: 
$$Activity_t = Frac_t(Up) - Frac_t(Down)$$ 
$$Confidence_t = Frac_{t+1}(Up) - Frac_{t+1}(Down)$$

This chapter calculates composite activity and confidence measures for each of the surveyed sectors. For each question, the responses are weighted by firm and subsector size, and balances are calculated.[^29] The composite sectoral indicators are calculated as the average of the weighted balances for the questions for each sector, as reported in Table 3.2. The activity measures also include the question (Q1) on business satisfaction used to calculate the BER BCI. Following the recommendation of the @INIS2014, the sectoral indicators are then weighted by GDP share to form the overall aggregate composite indicators.

[^29]: The weights for the construction and services subsectors were unavailable and therefore receive an equal weighting. 

Naturally, there are other ways to aggregate the indicators, but practical experience has shown that the balances are not very sensitive to the choice of weighting [@OECD2003]. Indeed, in this case the specific weighting turns out to have very little impact on the confidence indices. For many of the indicators, the weighted and unweighted versions are very similar, suggesting that the specific weighting adopted does not significantly alter the results. This confirms the results found by @Kershoff2015, who tested alternative methods of aggregation: a different allocation of firm size weights; the introduction of dynamic individual weights (post-stratification) to provide for changes in response patterns (to handle non-responses); the application of the OECD's two-step weighting procedure; the inclusion of latecomers to increase the number of responses; and the use of different sector size weights for export variables. The findings showed that the results were not sensitive to the alternative methods of aggregation.

###Uncertainty
There are relatively few proxies for macroeconomic uncertainty in South Africa. None of the proxies have fully exploited the information contained in the BER business tendency surveys. Following the literature (e.g. @Bachmann2010, @Bachmann2013, @Arslan2011, and @Girardi2015), this section calculates three composite forward-looking indicators of uncertainty: the scaled cross-sectional dispersion of forward-looking responses, and the cross-sectional average and dispersion of individual firm expectation errors. These measures are based on *ex ante* disagreement and *ex post* forecast error and capture a low level of predictability. The BER survey microeconomic data are particularly useful in this case as it allows individual firm expectation errors to be calculated, which is theoretically the stronger proxy for uncertainty.

The first measure of uncertainty is the scaled cross-sectional dispersion of forward-looking responses, using the same set of forward-looking survey questions as reported in Table 3.2 for each sector. For example (Q2P): *"[Expected development in next quarter] Compared with the same quarter of a year ago, will General Business Conditions be: Better, the Same, or Poorer?"* If the standard quantification method is used, this uncertainty measure is the cross-sectional standard deviation of responses: 
$$Disp_t = \sqrt(Frac_t(Up) + Frac_t(Down) - [Frac_t(Up) - Frac_t(Down)]^2) ,$$ where Frac_t(Up) is again defined as the weighted fraction of firms in the cross section responding with "better" at time $t$. 

@Bachmann2010 and @Bachmann2013 noted that there are two potential problems with simple dispersion as a proxy for uncertainty. First, time variation in the cross-sectional dispersion of responses may simply reflect firms reacting differently to aggregate shocks, without uncertainty changing over time.[^30] Second, time variation in dispersion may simply reflect time variation in the heterogeneity of expectations, without uncertainty changing over time. 

[^30]: They compared the "within" and "between" variance of uncertainty at a subsector level. The idea is that a difference in factor loadings for aggregate shocks might be due to industry-specific adjustment and production technologies. They argued that the finding of high "within" variance and the low "between" variance, implied that time series movements in dispersion were not explained by manufacturing subsectors getting more or less different over the business cycle. 

Accordingly, @Girardi2015 suggest scaling the forecast dispersion measures in period $t$ by the dispersion of questions on current conditions in period $t+1$. The idea is that respondents' assessments of current conditions should not be uncertain. The dispersion of an "activity" question does not reflect uncertainty, but the degree to which conditions differ between respondents. The dispersion of forward-looking questions reflects both the "natural" degree of dispersion and uncertainty about the future. This proxy measures of the extent of uncertainty, expressed as a share of the "natural" dispersion. The first uncertainty indicator (Dispersion) therefore measures the uncertainty-induced change in dispersion: 
$$Dispersion_t = ln(\frac{Disp^{forward}_{t}}{Disp^{current}_{t+1}})$$

@Bachmann2010 and @Bachmann2013 recommended a measure of the dispersion in *ex post* expectation errors. These are the errors in individual firm's expectations, which excludes varied but certain disagreement in expectations. The panel dimension of the survey is exploited to construct the *ex post* expectation errors. Pairs of questions are used to construct the expectation errors for each respondent, by comparing the expectations in period $t$ for a specific question to the realisations for that question in period $t+1$. For instance, the survey response to Q2P in period $t$ used to extract the expectations of general business conditions in time $t+1$ relative to $t-3$. The errors are then calculated by subtracting these expectations from the realisations from the responses to Q2A at time $t+1$ relative to $t-3$. For example, for a firm that expected an improvement in (i.e. better) conditions, the realisation of better conditions would be recorded as a 0 forecast error, no change as a -1 forecast error, and poorer conditions as a -2 expectation error. Table 3.3 illustrates the 9 possible expectation errors.

\begin{table}[]
\centering
\caption{Possible Expectation Errors}
\label{my-label}
\begin{tabular}{llrrr}
                          &                                &                             & $Q2A_{t+1}$               &                             \\ \cline{2-5} 
\multicolumn{1}{l|}{}     & \multicolumn{1}{l|}{}          & \multicolumn{1}{r|}{Better} & \multicolumn{1}{r|}{Same} & \multicolumn{1}{r|}{Poorer} \\ \cline{2-5} 
\multicolumn{1}{l|}{}     & \multicolumn{1}{l|}{E(Better)} & \multicolumn{1}{r|}{0}      & \multicolumn{1}{r|}{-1}   & \multicolumn{1}{r|}{-2}     \\ \cline{2-5} 
\multicolumn{1}{l|}{$Q2P_t$} & \multicolumn{1}{l|}{E(Same)}   & \multicolumn{1}{r|}{1}      & \multicolumn{1}{r|}{0}    & \multicolumn{1}{r|}{-1}     \\ \cline{2-5} 
\multicolumn{1}{l|}{}     & \multicolumn{1}{l|}{E(Poorer)} & \multicolumn{1}{r|}{2}      & \multicolumn{1}{r|}{1}    & \multicolumn{1}{r|}{0}      \\ \cline{2-5} 
\end{tabular}
\end{table}

Uncertainty is then measured as the cross-sectional standard deviation of the expectation errors in each quarter. Although it is based on the realised expectation errors in the next quarter, it depends on the knowledge and level of uncertainty in the current quarter. Thus, the standard deviation of realised expectation errors at time $t+1$ constitutes uncertainty in $t$ [@Bachmann2010]. 

One implication of this uncertainty indicator is that when all the firms make the same forecast error it implies no uncertainty. @Arslan2011 argued that firms make expectation errors because of uncertainty and that expectation errors should be treated as uncertainty. They call the measure used in @Bachmann2010 and @Bachmann2013 "idiosyncratic" uncertainty. It measures how individual firms depart from the overall mean on expectation errors. In addition, they suggest an "aggregate" uncertainty measure, which is defined as the square of the average expectation errors made across firms. Aggregate uncertainty increases if more firms make similar expectation errors. This is akin to the measures based on the mean of the absolute expectations errors proposed in @Bachmann2013. 

More formally, the second and third uncertainty indicators can be defined as: 
$$
\begin{aligned}
Idiosyncratic_t &= \sum_{i=1}^n (W_{i,t} - \overline W_t)^2/N \\
Aggregate_t &= \overline W_t^2 \\
Total_t &= \sum_{i=1}^n (W_{i,t})^2/N \\
Total_t &= Aggregate_t + Idiosyncratic_t  ,\\
\end{aligned}
$$
where $W_{i,t}$ is the expectation error of firm $i$ at time $t$ as introduced in Table 3.3, and $\overline W_t$ is the mean of expectations errors. 

If more firms make the same expectation errors, aggregate uncertainty will increase. If the same proportion of firms make positive and negative expectation errors, aggregate uncertainty will be zero, implying an environment where firms face only idiosyncratic uncertainty. @Arslan2011 found that idiosyncratic uncertainty did not capture economic downturns, while large spikes in aggregate uncertainty were followed by troughs in economic activity. 

To calculate the indicators for a specific question the weightings are applied in the same way as for the confidence indicators, i.e. firm size and subsector weights. @Jurado2015 argued that uncertainty manifests itself in a vast array of variables. Composite uncertainty indicators are therefore calculated as the average of a number of survey questions, as reported in Table 3.2. This should reduce their likelihood of producing "false positives", i.e. signalling high uncertainty where there is none, and "false negatives", i.e. failure to detect mounting uncertainty [@Girardi2015]. The sectoral indicators are then aggregated with GDP shares as weights to form the overall uncertainty indicators. These measures of cross-sectional dispersion are analogous to the forecaster disagreement proxy for uncertainty used by @Baker2013.

Thus, there are three distinct proxies for business uncertainty: Dispersion, Aggregate and Idiosyncratic uncertainty. However, business uncertainty can come from a number of sources. This chapter also investigates two other proxies for economic policy and financial market uncertainty. 

The economic policy uncertainty indicator is the news-based EPU index created by @Hlatshwayo2016. It is constructed by counting the number of articles that contained 3 mentions of words related to policy, economics, and uncertainty within 10 words of "South Africa". The absolute counts were normalised and the index was standardised.

The financial market uncertainty indicator is a combination of implied and realised stock market volatility. The South African Volatility Index (SAVI) is a forecast of equity market risk on the Johannesburg Stock Exchange (JSE). It is modelled on the VIX, a popular measure for the volatility of the S&P 500, which has been used in a number of studies (e.g. @Bloom2009). The SAVI is a forward-looking index that provides a daily prediction of market volatility in 3 months' time. It is calculated using implied volatilities obtained daily from specific Top 40 options [@JSE2014]. The SAVI is only available from June 2007. Following the literature (e.g. @Bloom2009, @Valencia2013, @Bachmann2013 and @Redl2015), an index of realised stock return volatility is calculated for the period before June 2007 and chained to the SAVI. The realised volatilities are calculated as the standard deviation of the daily JSE All Share index for each quarter. 

The three survey-based uncertainty indicators can be combined with these two alternative indicators to form an overall uncertainty indicator for South Africa. The idea is to iron out the remaining idiosyncrasies by averaging the indicators to incorporate information from different sources of uncertainty. This is similar to the literature where uncertainty indicators are constructed from a range of different proxies, e.g. @Baker2007; @Baker2015, @Redl2015 and @NWU2016. In constructing their uncertainty measure @Baker2007 and @Baker2015 use a simple average of their proxies, as well as the first principal component of the series.

This chapter uses the first principal component of the 5 standardised uncertainty proxies as an overall uncertainty measure (Uncertainty). A number of papers have used principal component analysis (PCA), or the related factor analysis, to reduce the dimensionality of their data (see. @Stock2002, @Gupta2011, and @Bosch2013). PCA is used to reduce the dimensionality of a dataset consisting of a large number of variables, while retaining as much of the variation as possible [@Jolliffe2002]. The transformation is defined in such a way that the first principal component accounts for as much of the variability in the data as possible (see @Jolliffe2002 for a complete derivation of PCA). The results presented below indicate that the combined indicator exhibits a larger correlation with movements in real output growth than any of the separate components. The results are similar for an equal weighted overall uncertainty index.

##Results: Confidence
This section presents the composite sectoral and aggregate business confidence indicators for South Africa. Simple linear interpolation is used for the few missing quarters. The internal and external validity of the indicators are assessed by comparing them to each other, and to the existing measures of confidence for South Africa. The indicators are then evaluated according to their comovement with real GDP growth (i.e. their tracking record), to assess whether they improve on the existing indicators.

###Confidence Indicators
```{r confidence, echo=FALSE, results='hide', message=FALSE, warning=FALSE, cache = TRUE}
##========================##
##----- CONFIDENCE -------##
##========================##
calc_conf <- function(data) {
    confidence <- aggregate(data[,(match("surveyQ",colnames(data))+1):ncol(data)], by=list(data$surveyQ), FUN=mean, na.rm=TRUE)
    confidence$Conf_cc <- rowMeans(confidence[,c("Q1","Q2A","Q3A","Q4A","Q5A","Q6A")],na.rm = TRUE, dims = 1)
    confidence$Conf_fl <- rowMeans(confidence[,c("Q2P","Q3P","Q4P","Q5P","Q6P")],na.rm = TRUE, dims = 1)
    #Row means for simple composite indicators (the question is which questions to include)
    confidence <- merge(datums,confidence,by.x="Date",by.y="Group.1", all=TRUE)
    confidence[,14:15] <- na.approx(confidence[,14:15],na.rm = FALSE)
    return(confidence)
}

calc_wconf <- function(data) {
    ##Weighted versions
    weeg <- function(temp) {  #calculate weighted mean for each quarter for all columns
        temp <- cbind(factor=temp$factor,temp$factor*temp[(match("surveyQ",colnames(temp))+1):ncol(temp)])
        #temp <- colSums(temp, na.rm=TRUE, dims = 1)/sum(temp$factor, na.rm=TRUE)
        #calculate the sum(wi*xi)/sum(wi)
        temp <- colSums(temp, na.rm=TRUE, dims = 1)/    
            sapply(colnames(temp), function(x) sum(temp$factor[!is.na(temp[colnames(temp) == x])]))
        #weight only by those that responded to a specific question
        return(temp)
    }
    
    w.confidence <- as.data.frame(t(sapply(levels(data$surveyQ), function(kwartaal) weeg(data[data$surveyQ==kwartaal,]))))
    w.confidence$Conf_cc <- rowMeans(w.confidence[,c("Q1","Q2A","Q3A","Q4A","Q5A","Q6A")],na.rm = TRUE, dims = 1)
    w.confidence$Conf_fl <- rowMeans(w.confidence[,c("Q2P","Q3P","Q4P","Q5P","Q6P")],na.rm = TRUE, dims = 1)
    #w.confidence$Conf_all <- rowMeans(w.confidence[,c("Q1","Q2A","Q3A","Q4A","Q5A","Q6A","Q2P","Q3P","Q4P","Q5P","Q6P")],na.rm = TRUE, dims = 1)
    w.confidence <- merge(datums,w.confidence,by.x="Date",by.y="row.names", all=TRUE)[,-3]
    w.confidence[,14:15] <- na.approx(w.confidence[,14:15],na.rm = FALSE)
    
    return(w.confidence)
}

##======================##
## CALCULATE INDICATORS ##
##======================##
indicators.M <- calc_conf(BER[BER$Sector=="Manufacturing",])
w.indicators.M <- calc_wconf(BER[BER$Sector=="Manufacturing",])

indicators.B <- calc_conf(BER[BER$Sector=="Construction",])
w.indicators.B <- calc_wconf(BER[BER$Sector=="Construction",])

indicators.T <- calc_conf(BER[BER$Sector=="Trade",])
w.indicators.T <- calc_wconf(BER[BER$Sector=="Trade",])

indicators.S <- calc_conf(BER[BER$Sector=="Services",])
w.indicators.S <- calc_wconf(BER[BER$Sector=="Services",])

indicators <- calc_conf(BER)[c(2,14:15)]
colnames(indicators) <- c("Date","Activity","Confidence")

##=================================##
##Weighted versions
weights <- GDPdata[,c(1:4,6)]
activity <- cbind(w.indicators.M[,c(2,14)],w.indicators.B[,14],w.indicators.T[,14],w.indicators.S[,14])
colnames(activity) <- c("Date","Manufacturing","Construction","Trade","Services")
conf <- cbind(w.indicators.M[,c(2,15)],w.indicators.B[,15],w.indicators.T[,15],w.indicators.S[,15])
colnames(conf) <- c("Date","Manufacturing","Construction","Trade","Services")

#create weighted means by GDP share
activity$Activity <- sapply(activity$Date, function(x) weighted.mean(activity[which(activity$Date==x),c(2:5)], 
                                                                     weights[weights$Date==x,-1],na.rm=TRUE))
conf$Confidence <- sapply(conf$Date, function(x) weighted.mean(conf[which(conf$Date==x),c(2:5)], 
                                                               weights[weights$Date==x,-1],na.rm=TRUE))
w.indicators <- cbind(activity[,c(1,6)],conf[,6])
colnames(w.indicators) <- c("Date","Activity","Confidence")
```

Figure 3.2 illustrates the weighted sectoral Activity and Confidence indicators, which capture cyclical movements in the sectors. The confidence indicators lead the activity indicators in each of the sectors, with turning points generally before the activity measures. This is what one would expect, given that the confidence indicators are based on forward-looking questions. 

```{r figure3.2, echo=FALSE, warning=FALSE, message=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="Weighted Sectoral Activity and Confidence Indicators"}
index_plot <- w.indicators.M[,c(2,14:15)]
colnames(index_plot) <- c("Date","Activity","Confidence")
index_plot <- melt(index_plot, id="Date")  # convert to long format
g1 <- ggplot(index_plot, aes(x=Date,y=value,group=variable,colour=variable)) 
g1 <- g1 + geom_line()
g1 <- g1 + theme(legend.title=element_blank())
g1 <- g1 + ggtitle("Manufacturing") 
g1 <- g1 + ylab("Indicator") + xlab("")
g1 <- g1 + theme(legend.position="none")
g1 <- g1 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g1 <- g1 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))

index_plot <- w.indicators.B[,c(2,14:15)]
colnames(index_plot) <- c("Date","Activity","Confidence")
index_plot <- melt(index_plot, id="Date")  # convert to long format
g2 <- ggplot(index_plot, aes(x=Date,y=value,group=variable,colour=variable)) 
g2 <- g2 + geom_line()
g2 <- g2 + theme(legend.title=element_blank())
g2 <- g2 + ggtitle("Construction") 
g2 <- g2 + ylab("") + xlab("")
g2 <- g2 + theme(legend.position="none")
g2 <- g2 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g2 <- g2 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))

index_plot <- w.indicators.T[,c(2,14:15)]
colnames(index_plot) <- c("Date","Activity","Confidence")
index_plot <- melt(index_plot, id="Date")  # convert to long format
g3 <- ggplot(index_plot, aes(x=Date,y=value,group=variable,colour=variable)) 
g3 <- g3 + geom_line()
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + ggtitle("Trade") 
g3 <- g3 + ylab("Indicator") + xlab("")
g3 <- g3 + theme(legend.position="bottom",plot.margin=unit(c(-0.5,0.4,0,0.4), "cm"))
g3 <- g3 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g3 <- g3 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))

index_plot <- w.indicators.S[-1:-52,c(2,14:15)]
colnames(index_plot) <- c("Date","Activity","Confidence")
index_plot <- melt(index_plot, id="Date")  # convert to long format
g4 <- ggplot(index_plot, aes(x=Date,y=value,group=variable,colour=variable)) 
g4 <- g4 + geom_line()
g4 <- g4 + theme(legend.title=element_blank())
g4 <- g4 + ggtitle("Services") 
g4 <- g4 + ylab("") + xlab("")
g4 <- g4 + theme(legend.position="bottom",plot.margin=unit(c(-0.5,0.4,0,0.4), "cm"))
g4 <- g4 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g4 <- g4 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))

library(gridExtra)
grid.arrange(g1, g2, g3, g4, ncol=2, nrow =2)
```

Figure 3.3 illustrates the weighted aggregate Activity and Confidence indicators. The shaded areas denote the recessionary periods according to the official turning points of the SARB. The indices follow a similar cyclical trend over the period and are very highly correlated, as reported in Table 3.4 below. The Confidence index leads changes in the Activity index to some extent. The indicators appear to match the different phases of the business cycle relatively well. Turning points were generally before the official turning points, as discussed in more detail below. 

```{r figure3.3, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="Weighted Activity and Confidence Indicators"}
index_plot <- w.indicators
g <- ggplot(index_plot) 
g <- g + geom_line(aes(x=Date, y=Activity, colour="Activity"), size = 1)
g <- g + geom_line(aes(x=Date, y=Confidence, colour="Confidence"), size = 1)
g <- g + labs(color="Legend text")
g <- g + geom_rect(data=recessions.df, aes(xmin=Peak, xmax=Trough, ymin=-Inf, ymax=+Inf), fill='grey', alpha=0.5)
g <- g + ylab("Indicator") + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank()) 
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"), expand=c(0,0), 
                      limits = as.Date(c("1990-12-31", NA)))
g <- g + theme(legend.position="bottom")
g
```

The survey-based indicators appear to be plausible and potentially useful indicators of business confidence in South Africa. The following section tests validity more formally and evaluates the indicators in terms of their tracking record, i.e. to what extent do they track real GDP growth. The unweighted versions of the indicators, calculated by stacking all of the available responses from all the surveys (i.e. completely unweighted), are very similar but slightly less volatile than the weighted versions. The specific weighting adopted therefore turns out to have little impact on the confidence indices and the subsequent results. The same is true of the respective sectoral indices.

###Validity Tests and Evaluation
This section compares the characteristics of the Activity and Confidence indicators to the two existing South African business confidence indices, the BER BCI and the SACCI BCI. Correlations are then used to analyse the tracking record of the indicators with respect to their reference series (i.e. real GDP growth). The relationships between turning points is reported, to indicate their usefulness as leading indicators. 

####Correlations between confidence indicators and real GDP growth
Figure 3.4 compares the Activity and Confidence indicators to the BER and SACCI BCIs, as well as real GDP growth. Real GDP growth is measured as annual quarter-on-quarter growth, e.g. 2015Q1 over 2014Q1, which corresponds to the reference period in the BER surveys. Recessionary periods are shaded and the indicators are standardised for plotting. The indicators appear to be strongly pro-cyclical, and follow real GDP growth closely. 

```{r figure3.4, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="Weighted Indicators compared the BER BCI and SACCI BCI"}
conf_indices <- cbind(w.indicators,GDPdata$BER_BCI, GDPdata$SACCI_BCI,GDPgrowth4$RGDP)
colnames(conf_indices) <- c("Date","Activity","Confidence","BER_BCI","SACCI_BCI","RGDP_Growth")

index_plot <- conf_indices
index_plot[,2:6] <- scale(index_plot[,2:6])
g <- ggplot(index_plot) 
g <- g + geom_line(aes(x=Date, y=Activity, colour="Activity"), size = 1)
g <- g + geom_line(aes(x=Date, y=Confidence, colour="Confidence"), size = 1)
g <- g + geom_line(aes(x=Date, y=BER_BCI, colour="BER_BCI"), size = 1)
g <- g + geom_line(aes(x=Date, y=SACCI_BCI, colour="SACCI_BCI"), size = 1)
g <- g + geom_line(aes(x=Date, y=RGDP_Growth, colour="RGDP_Growth"), size = 1)
g <- g + labs(color="Legend text")
g <- g + geom_rect(data=recessions.df, aes(xmin=Peak, xmax=Trough, ymin=-Inf, ymax=+Inf), fill='grey', alpha=0.5)
g <- g + ylab("Indicator") + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank()) 
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"), expand=c(0,0),limits = as.Date(c("1990-12-31", NA)))
g <- g + theme(legend.position="bottom")
g
```

The tracking record of the indicators is measured by their correlation with the corresponding quantitative reference series. Table 3.4 reports the contemporaneous correlations of the indicators and real GDP growth. All the indicators exhibit a significant positive correlation with real GDP growth. The Activity indicator has a higher contemporaneous correlation with real GDP growth than the BER BCI or SACCI BCI, which are also based on current conditions. One would expect indicators of current conditions to have a better tracking record than indicators of forward-looking expectations, although the correlation of the Confidence indicator is still relatively high (especially compared to the SACCI BCI).

```{r table3.4, echo=FALSE, results='asis', warning=FALSE, message=FALSE, cache = TRUE}
source("corstarsl.R")
xt <- xtable(corstarsl(conf_indices[,-1]), caption="Correlations in Levels")
print(xt, "latex",comment=FALSE, caption.placement = getOption("xtable.caption.placement", "top"), scalebox = 0.8)
```

Cross-correlations can be used to illustrate the dynamic relationships between the indicators and real GDP growth. Figure 3.5 illustrates the cross-correlograms for the indicators and real GDP growth. All three survey-based measures exhibit relatively high correlations with lagged GDP growth. The highest correlation coefficient between the indicators of current activity and real GDP growth occur contemporaneously. The Confidence measure leads the other indicators and GDP growth. It exhibits the highest correlation coefficient with 1-period lagged real GDP growth. The results imply that the indicators are all potentially useful leading or quasi-leading indicators of real activity.  

```{r figure3.5, echo=FALSE, warning=FALSE, message=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="Cross-correlograms of confidence indicators and real GDP growth"}
Activity <- conf_indices[,2]
Confidence <- conf_indices[,3]
BER_BCI <- conf_indices[,4]
SACCI_BCI <- conf_indices[,5] 
RGDP_Growth <- conf_indices[,6]

par(mfrow=c(2,2))
ccf(Activity, RGDP_Growth, na.action = na.pass, ylim=c(-0.3, 0.8))
ccf(Confidence, RGDP_Growth, na.action = na.pass, ylim=c(-0.3, 0.8))
ccf(BER_BCI, RGDP_Growth, na.action = na.pass, ylim=c(-0.3, 0.8))
ccf(SACCI_BCI, RGDP_Growth, na.action = na.pass, ylim=c(-0.3, 0.8))
```

Figure 3.6 compares the sectoral Activity and Confidence indicators to the BER sectoral indicators,[^31] as well as the corresponding real sectoral GDP growth rates. The indicators capture cyclical movements in real output over the period. Table 3.5 reports the contemporaneous correlations of the sectoral indicators and their respective sectoral real GDP growth rates. All the indicators are highly positively correlated with real GDP growth rates. For the most part the Activity indicators display the best tracking record, with the highest correlation with the reference series. In this sense they are an improvement on existing confidence indicators. There are two exceptions. In the manufacturing sector, the Confidence indicator exhibits the highest contemporaneous correlation. In the construction sector, the BER BCI has the highest correlation, which is interesting, as their measure includes only building contractors. 

[^31]: The BER does not publish a confidence indicator for the services sector.

```{r figure3.6, echo=FALSE, warning=FALSE, message=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="Weighted Sectoral Activity and Confidence Indicators"}

manufac <- cbind(w.indicators.M[,c(2,14:15)],(GDPdata$ManuConf-50)/50, GDPgrowth4$Manufacturing)
colnames(manufac) <- c("Date","Activity","Confidence","BER_BCI","RGDP")

construct <- cbind(w.indicators.B[,c(2,14:15)],(GDPdata$BuildingConf-50)/50, GDPgrowth4$Construction)
colnames(construct) <- c("Date","Activity","Confidence","BER_BCI","RGDP_Growth")

GDPdata$TradeConf <- rowMeans(GDPdata[,c(14,15,17)])
trade <- cbind(w.indicators.T[,c(2,14:15)],(GDPdata$TradeConf-50)/50, GDPgrowth4$Trade)
colnames(trade) <- c("Date","Activity","Confidence","BER_BCI","RGDP")

services <- cbind(w.indicators.S[,c(2,14:15)], GDPgrowth4$Services)
colnames(services) <- c("Date","Activity","Confidence","RGDP")
services$BER_BCI <- 1
services <- services[,c(1,2,3,5,4)]

index_plot <- manufac
index_plot[,-1] <- scale(index_plot[,-1])
index_plot <- melt(index_plot, id="Date")  # convert to long format
g1 <- ggplot(index_plot, aes(x=Date,y=value,group=variable,colour=variable)) 
g1 <- g1 + geom_line()
g1 <- g1 + theme(legend.title=element_blank())
g1 <- g1 + ggtitle("Manufacturing") 
g1 <- g1 + ylab("Indicator") + xlab("")
g1 <- g1 + theme(legend.position="none")
g1 <- g1 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g1 <- g1 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))

index_plot <- construct
index_plot[,-1] <- scale(index_plot[,-1])
index_plot <- melt(index_plot, id="Date")  # convert to long format
g2 <- ggplot(index_plot, aes(x=Date,y=value,group=variable,colour=variable)) 
g2 <- g2 + geom_line()
g2 <- g2 + theme(legend.title=element_blank())
g2 <- g2 + ggtitle("Construction") 
g2 <- g2 + ylab("") + xlab("")
g2 <- g2 + theme(legend.position="none")
g2 <- g2 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g2 <- g2 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))

index_plot <- trade
index_plot[,-1] <- scale(index_plot[,-1])
index_plot <- melt(index_plot, id="Date")  # convert to long format
g3 <- ggplot(index_plot, aes(x=Date,y=value,group=variable,colour=variable)) 
g3 <- g3 + geom_line()
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + ggtitle("Trade") 
g3 <- g3 + ylab("Indicator") + xlab("")
g3 <- g3 + theme(legend.position="bottom",plot.margin=unit(c(-0.5,0.4,0,0.4), "cm"))
g3 <- g3 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g3 <- g3 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))

index_plot <- services
index_plot[,-1] <- scale(index_plot[,-1])
index_plot <- melt(index_plot, id="Date")  # convert to long format
g4 <- ggplot(index_plot, aes(x=Date,y=value,group=variable,colour=variable)) 
g4 <- g4 + geom_line()
g4 <- g4 + theme(legend.title=element_blank())
g4 <- g4 + ggtitle("Services") 
g4 <- g4 + ylab("") + xlab("")
g4 <- g4 + theme(legend.position="bottom",plot.margin=unit(c(-0.5,0.4,0,0.4), "cm"))
g4 <- g4 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g4 <- g4 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))

library(gridExtra)
grid.arrange(g1, g2, g3, g4, ncol=2, nrow =2)
```

```{r table3.5, echo=FALSE, results='asis', warning=FALSE, message=FALSE, cache = TRUE}
source("corstarsl.R")
xt1 <- cbind(corstarsl(manufac[,-1]),corstarsl(construct[,-1]))
xt2 <- cbind(corstarsl(trade[,-1]),corstarsl(services[,-1]))
xt1 <- sapply(xt1,as.character)
xt2 <- sapply(xt2,as.character)
xt2[3,4:5] <- ""
xt2[4,6] <- ""
xt1[1,] <- c("Activity","Confidence","BER_BCI","Activity","Confidence","BER_BCI")
xt2[1,] <- c("Activity","Confidence","BER_BCI","Activity","Confidence","BER_BCI")
colnames(xt1) <- c(" ","Manufacturing"," "," ","Construction"," ")
colnames(xt2) <- c(" ","Trade"," "," ","Services"," ")
row.names(xt1) <- c("Activity","Confidence","BER_BCI","RGDP_Growth")
row.names(xt2) <- c("Activity","Confidence","BER_BCI","RGDP_Growth")

xt <- xtable(xt1, caption="Correlations in Levels")
print(xt, "latex",comment=FALSE, caption.placement = getOption("xtable.caption.placement", "top"), scalebox = 0.8)
xt <- xtable(xt2)
print(xt, "latex",comment=FALSE, caption.placement = getOption("xtable.caption.placement", "top"), scalebox = 0.85)
```

Figure 3.7 illustrates the cross-correlograms for the Manufacturing indicators and real GDP growth in the Manufacturing sector. The results are fairly similar to the aggregate results. Again, all three survey-based measures exhibit relatively high correlations with lagged GDP growth and the Confidence measure leads the other indicators and real GDP growth. The cross-correlograms for the other sectors are very similar, except in the Services sector, where the Confidence measure has even longer leading relationship with real GDP growth.  

```{r figure3.7, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="Cross-correlograms of Manufacturing indicators and real GDP growth"}
calc_ccf <- function(data, serv=0) {
    Activity <- data[,2]
    Confidence <- data[,3]
    BER_BCI <- data[,4]
    RGDP_Growth <- data[,5]

    par(mfrow=c(2,2))
    ccf(Activity, RGDP_Growth, na.action = na.pass, ylim=c(-0.3, 0.8))
    ccf(Confidence, RGDP_Growth, na.action = na.pass, ylim=c(-0.3, 0.8))
    if(serv==0) { ccf(BER_BCI, RGDP_Growth, na.action = na.pass, ylim=c(-0.3, 0.8)) }
}

calc_ccf(manufac)
#calc_ccf(construct)
#calc_ccf(trade)
#calc_ccf(services, 1)
```

####Turning points
An accurate leading indicator should show general conformity to economic activity (i.e. high correlation), as well as a consistent matching of turning points with the reference cycle. Although there are too few cycles over the sample period to analyse cyclical turning points in full detail, it is still of interest to assess whether the indicators behave in a systematic way around cyclical turning points. In other words, do they systematically lead, coincide with, or lag peaks and troughs of the business cycle. 

The turning points in the indicators are determined with the so-called Bry-Boschan method. It is a non-parametric dating algorithm that automates the Burns & Mitchell approach to determining classical turning points [@Bry1971]. The algorithm identifies local minima (troughs) and maxima (peaks) in a single time series. Censoring rules in the algorithm ensure that phases and cycles have a minimum duration. The algorithm has the advantage that it is a simple, transparent, easily replicable, and provides intuitively appealing results [@DuPlessis2006]. A variant of this algorithm for dealing with quarterly data, called the BBQ method, was developed by @Harding2002. Following their suggestion, a censoring rule based on a minimum of 2 quarters for each phase and 5 quarters for a full cycle is applied. 

The resulting turning points are illustrated in Figure 3.8, with recessionary periods shaded. The top panel of each graph illustrates the turning points of the confidence indices, while the bottom panel of each graph shows the official SARB reference turning points. The sample period includes 3 upswing phases and 4 recessionary periods. In addition, in 2001 and 2003 the SARB indicators pointed to possible reference turning points. Although the SARB dating committee decided at the time that neither of these periods qualified, subsequent data revisions have shown that in hindsight there could have been official peaks, especially in 2003, if the dating procedure had been followed mechanically [@Venter2005a].

```{r turn, echo=FALSE, results='hide', message=FALSE, warning=FALSE, cache = TRUE}
#Turning Points
suppressMessages(library(BCDating))

turning.df = read.table(textConnection(
    "Peaks,  Troughs 
         ,  1993Q2 
    1996Q4, 1999Q3 
    2007Q4, 2009Q3 
    2013Q4, "), 
    sep=',', header=TRUE)

dat <- BBQ(ts(conf_indices[,2],start =c(1992,1),end=c(2015,3),frequency=4), mincycle = 5, minphase = 2, name="Activity")
tp1 <- as.data.frame(show(dat))[,-3]
dat <- BBQ(ts(conf_indices[,3],start =c(1992,1),end=c(2015,3),frequency=4), mincycle = 5, minphase = 2, name="Activity")
tp2 <- as.data.frame(show(dat))[,-3]
dat <- BBQ(ts(conf_indices[,4],start =c(1992,1),end=c(2015,3),frequency=4), mincycle = 5, minphase = 2, name="Activity")
tp3 <- as.data.frame(show(dat))[,-3]
dat <- BBQ(ts(conf_indices[,5],start =c(1992,1),end=c(2015,3),frequency=4), mincycle = 5, minphase = 2, name="Activity")
tp4 <- as.data.frame(show(dat))[,-3]
dat <- BBQ(ts(conf_indices[,6],start =c(1992,1),end=c(2015,3),frequency=4), mincycle = 5, minphase = 2, name="Activity")
tp5 <- as.data.frame(show(dat))[,-3]

detach("package:BCDating", unload=TRUE)

maak_datums <- function(data) {
    data$Peak <- as.Date(as.yearqtr(data[,1], format = "%YQ%q"), frac = 1)
    data$Trough <- as.Date(as.yearqtr(data[,2], format = "%YQ%q"), frac = 1)
    data$Peak[1] <- "1990-12-31"
    data$Trough[nrow(data)] <- "2016-12-31"
    return(data)
}

tp1 <- maak_datums(tp1)
tp2 <- maak_datums(tp2)
tp3 <- maak_datums(tp3)
tp4 <- maak_datums(tp4)
tp5 <- maak_datums(tp5)
```

```{r figure3.8, echo=FALSE, warning=FALSE, message=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="Confidence indicator turning points compared to the official SARB turning points"}
index_plot <- conf_indices[,c(1,2)]
index_plot[,2] <- scale(index_plot[,2])
colnames(index_plot) <- c("Date","Confidence")
g1 <- ggplot(index_plot) 
g1 <- g1 + geom_line(aes(x=Date, y=Confidence, colour="Confidence"), size = 0.5)
g1 <- g1 + labs(color="Legend text")
g1 <- g1 + geom_rect(data=recessions.df, aes(xmin=Peak, xmax=Trough, ymin=-Inf, ymax=0), fill='grey', alpha=0.5)
g1 <- g1 + geom_rect(data=tp1, aes(xmin=Peak, xmax=Trough, ymin=0, ymax=+Inf), fill='blue', alpha=0.5)
g1 <- g1 + ylab("Indicator") + xlab("")
g1 <- g1 + ggtitle("Activity") 
g1 <- g1 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g1 <- g1 + theme(legend.title=element_blank()) 
g1 <- g1 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"), expand=c(0,0),
                      limits = as.Date(c("1990-12-31", NA)))
g1 <- g1 + theme(legend.position="none")

index_plot <- conf_indices[,c(1,3)]
index_plot[,2] <- scale(index_plot[,2])
colnames(index_plot) <- c("Date","Confidence")
g2 <- ggplot(index_plot) 
g2 <- g2 + geom_line(aes(x=Date, y=Confidence, colour="Confidence"), size = 0.5)
g2 <- g2 + labs(color="Legend text")
g2 <- g2 + geom_rect(data=recessions.df, aes(xmin=Peak, xmax=Trough, ymin=-Inf, ymax=0), fill='grey', alpha=0.5)
g2 <- g2 + geom_rect(data=tp2, aes(xmin=Peak, xmax=Trough, ymin=0, ymax=+Inf), fill='blue', alpha=0.5)
g2 <- g2 + ylab("") + xlab("")
g2 <- g2 + ggtitle("Confidence") 
g2 <- g2 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g2 <- g2 + theme(legend.title=element_blank()) 
g2 <- g2 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"), expand=c(0,0),
                        limits = as.Date(c("1990-12-31", NA)))
g2 <- g2 + theme(legend.position="none")

index_plot <- conf_indices[,c(1,4)]
index_plot[,2] <- scale(index_plot[,2])
colnames(index_plot) <- c("Date","Confidence")
g3 <- ggplot(index_plot) 
g3 <- g3 + geom_line(aes(x=Date, y=Confidence, colour="Confidence"), size = 0.5)
g3 <- g3 + labs(color="Legend text")
g3 <- g3 + geom_rect(data=recessions.df, aes(xmin=Peak, xmax=Trough, ymin=-Inf, ymax=0), fill='grey', alpha=0.5)
g3 <- g3 + geom_rect(data=tp3, aes(xmin=Peak, xmax=Trough, ymin=0, ymax=+Inf), fill='blue', alpha=0.5)
g3 <- g3 + ylab("Indicator") + xlab("")
g3 <- g3 + ggtitle("BER BCI") 
g3 <- g3 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g3 <- g3 + theme(legend.title=element_blank()) 
g3 <- g3 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"), expand=c(0,0),
                        limits = as.Date(c("1990-12-31", NA)))
g3 <- g3 + theme(legend.position="none")

index_plot <- conf_indices[,c(1,5)]
index_plot[,2] <- scale(index_plot[,2])
colnames(index_plot) <- c("Date","Confidence")
g4 <- ggplot(index_plot) 
g4 <- g4 + geom_line(aes(x=Date, y=Confidence, colour="Confidence"), size = 0.5)
g4 <- g4 + labs(color="Legend text")
g4 <- g4 + geom_rect(data=recessions.df, aes(xmin=Peak, xmax=Trough, ymin=-Inf, ymax=0), fill='grey', alpha=0.5)
g4 <- g4 + geom_rect(data=tp4, aes(xmin=Peak, xmax=Trough, ymin=0, ymax=+Inf), fill='blue', alpha=0.5)
g4 <- g4 + ylab("") + xlab("")
g4 <- g4 + ggtitle("SACCI BCI") 
g4 <- g4 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g4 <- g4 + theme(legend.title=element_blank()) 
g4 <- g4 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"), expand=c(0,0),
                        limits = as.Date(c("1990-12-31", NA)))
g4 <- g4 + theme(legend.position="none")

library(gridExtra)
grid.arrange(g1, g2, g3, g4, ncol=2, nrow =2)

```

The BBQ algorithm identifies 9 cycles in the Activity indicator and 7 cycles in the Confidence indicator over the period. Four of these cycles correspond to the official business cycles. The turning points in the BER and SACCI BCI were similar to those for the Activity and Confidence indicators. As the indicators are quite volatile, the default censoring rule produces a number of shorter cycles (or false positives) around the ambiguous period of 2000-2003, and latter part (2012-2015) of the sample period. The indicators exhibited troughs before the 3 official trough dates, between 1 and 4 quarters before they occurred. The indicators exhibited peaks long before the official peak dates, in some cases as much as 12 quarters before they occurred. The indicators therefore provided advanced warning of turning points, albeit long before the official peaks. The false positives are problematic for the use of the indicators as early warning signals. Still, the reference series, real GDP growth, exhibited even more cycles when dated with the BBQ method. Its cycles corresponded more closely with those of the indicators. 

The co-movement between these cycle phases can be measured with the concordance statistic suggested by @Harding2002. The concordance statistic measures the co-movement of two series, by considering the proportion of time the two series are simultaneously in the same phase. This entails testing whether $I=Pr(S_{xt} =S_{yt})$ is close to 1, where $S_{xt} = 1$ identifies an expansion in indicator $x_t$, and $S_{yt}=1$ identifies a business cycle upswing phase at time $t$. The statistic is calculated as follows: $I = 1/T [\sum^T_{t=1} S_{xt} S_{yt} + \sum^T_{t=1} (1-S_{xt}) (1- S_{yt})$. Following @Harding2006, statistical significance is calculated with heteroskedasticity and autocorrelation consistent standard errors.

Table 3.6 reports the concordance statistics for the phases of the indicator variables, compared to the official SARB reference turning points, as well as the phases in real GDP growth (identified with the BBQ algorithm). The indicators exhibited significant concordance with the official SARB business cycle as well as the growth rate cycle. Compared to the official SARB cycle, the indicators have the highest concordance statistic when leading the cycle by 2 quarters. The Confidence and SACCI BCI measures have the highest concordance statistics with the official SARB cycle. Compared to the real GDP growth cycle, the survey-based indicators have the highest concordance statistic when they lead the cycle by 1 quarter. For the SACCI BCI it occurs with zero lag. The Activity indicator has the highest concordance statistic with the real GDP growth cycle, and in this sense it is an improvement on existing indicators. 

\begin{table}[ht]
\centering
\caption{Concordance Statistics} 
\scalebox{0.8}{
\begin{tabular}{rllllllll}
  \hline
  & \multicolumn{4}{c}{  SARB Cycle  } & \multicolumn{4}{c}{ RGDP Growth cycle }\\ \hline
  & Activity & Confidence & BER\_BCI & SACCI\_BCI & Activity & Confidence & BER\_BCI & SACCI\_BCI \\ 
  lag=0 & 0.684**  & 0.653*  & 0.579  & 0.653*  & 0.768*** & 0.653**  & 0.663**  & 0.632**  \\ 
  lag=1 & 0.695**  & 0.705**  & 0.611*  & 0.684**  & 0.8*** & 0.684**  & 0.674**  & 0.558  \\ 
  lag=2 & 0.705*** & 0.716**  & 0.642*  & 0.716*** & 0.684*** & 0.674**  & 0.642**  & 0.505  \\ 
  lag=3 & 0.695**  & 0.705*** & 0.611*  & 0.695*** & 0.526  & 0.621*  & 0.568  & 0.463  \\ 
   \hline
\end{tabular}
}
\end{table}

This section has presented the new composite confidence indicators. The validity tests indicate that the two composite indicators, Activity and Confidence, are highly correlated with each other and with the two existing measures of confidence. All the indicators examined in this section exhibit a significant positive correlation with real GDP growth. The Activity indicators generally had the highest correlation with real GDP growth and therefore the most successful tracking record. The indicators provided advanced warning of turning points, although there were a few false signals, especially over the ambiguous period of 2000-2003. The indicators also exhibited significant concordance with the phases of the business cycle, with a lead of 1 or 2 quarters. This implies that they are potentially useful leading indicators. As more microeconomic data from the BER's business tendency surveys become available, the analysis could be expanded by analysing the cyclical properties of the indicators in terms of duration, amplitude and steepness. 

##Results: Uncertainty
This section uses the quarterly BER business tendency surveys and the methodology described above to calculate composite sectoral and aggregate indicators of uncertainty for South Africa. The few missing quarters are interpolated and all the indicators are standardised. The internal and external validity of the survey-based indicators are assessed by comparing them to each other, and to the existing measures of uncertainty for South Africa. The indicators are then evaluated according in terms of their comovement with real GDP growth. A combined indicator is then created, which turns out to have a more significant relationship with real GDP growth than any of the indicators alone.

###Uncertainty Indicators
```{r dispersion, echo=FALSE, results='hide', message=FALSE, warning=FALSE, cache = TRUE}
##========================##
## ---- UNCERTAINTY ------##
##========================##
se <- function(x) sqrt(var(x,na.rm=TRUE)/length(na.omit(x))*(length(na.omit(x))-1)) #adjust for (n-1)
##------------##
## Dispersion                    
##------------##

calc_uncert <- function(data) {
    uncertainty <- aggregate(data[,(match("surveyQ",colnames(data))+1):ncol(data)], by=list(data$surveyQ), FUN=se)
    uncertainty$Uncert_cc <- rowMeans(uncertainty[,c("Q2A","Q3A","Q4A","Q5A","Q6A")],na.rm = TRUE, dims = 1)
    uncertainty$Uncert_fl <- rowMeans(uncertainty[,c("Q2P","Q3P","Q4P","Q5P","Q6P")],na.rm = TRUE, dims = 1)
    #Row means for simple composite indicators (the question is which questions to include)
    uncertainty <- merge(datums,uncertainty,by.x="Date",by.y="Group.1", all=TRUE)
    uncertainty[,14:15] <- na.approx(uncertainty[,14:15],na.rm = FALSE)
    for(t in 2:nrow(uncertainty)) { uncertainty$Disp[t-1] <- uncertainty$Uncert_fl[t-1]/uncertainty$Uncert_cc[t] }
    uncertainty$Disp[t] <- NA
    return(uncertainty)
}

calc_wuncert <- function(data) {
    ##Weighted versions
    weeg.2 <- function(temp) {  #calculate weighted standard deviation for each quarter for all columns
        temp <- cbind(factor=temp$factor,temp$factor*temp[(match("surveyQ",colnames(temp))+1):ncol(temp)])
        #calculate total that responded up (1) and down (-1) over sum(wi) = fractions up and down
        frac.up <- sapply(1:ncol(temp), function(x) sum(temp[which(temp[,x]>0),x],na.rm=TRUE))/
            sapply(colnames(temp), function(x) sum(temp$factor[!is.na(temp[colnames(temp) == x])]))
        frac.dn <- sapply(1:ncol(temp), function(x) sum(temp[which(temp[,x]<0),x],na.rm=TRUE))/
            sapply(colnames(temp), function(x) sum(temp$factor[!is.na(temp[colnames(temp) == x])]))
        #weight only by those that responded to a specific question 
        ind <- sqrt(frac.up-frac.dn-(frac.up+frac.dn)^2)        #this is the standard devation
        return(ind)
    }
    
    w.uncertainty <- as.data.frame(t(sapply(levels(data$surveyQ), function(kwartaal) weeg.2(data[data$surveyQ==kwartaal,]))))
    w.uncertainty$Uncert_cc <- rowMeans(w.uncertainty[,c("Q1","Q2A","Q3A","Q4A","Q5A","Q6A")],na.rm = TRUE, dims = 1)
    w.uncertainty$Uncert_fl <- rowMeans(w.uncertainty[,c("Q2P","Q3P","Q4P","Q5P","Q6P")],na.rm = TRUE, dims = 1)
    w.uncertainty <- merge(datums,w.uncertainty,by.x="Date",by.y="row.names", all=TRUE)[,-3]
    w.uncertainty[,14:15] <- na.approx(w.uncertainty[,14:15],na.rm = FALSE)
    for(t in 2:nrow(w.uncertainty)) { w.uncertainty$Disp[t-1] <- w.uncertainty$Uncert_fl[t-1]/w.uncertainty$Uncert_cc[t] }
    w.uncertainty$Disp[t] <- NA
    return(w.uncertainty)
}

uncertainty.M <- calc_uncert(BER[BER$Sector=="Manufacturing",])
w.uncertainty.M <- calc_wuncert(BER[BER$Sector=="Manufacturing",])

uncertainty.B <- calc_uncert(BER[BER$Sector=="Construction",])
w.uncertainty.B <- calc_wuncert(BER[BER$Sector=="Construction",])

uncertainty.T <- calc_uncert(BER[BER$Sector=="Trade",])
w.uncertainty.T <- calc_wuncert(BER[BER$Sector=="Trade",])

uncertainty.S <- calc_uncert(BER[BER$Sector=="Services",])
w.uncertainty.S <- calc_wuncert(BER[BER$Sector=="Services",])

uncertainty <- calc_uncert(BER)

##Weighted versions
weights <- GDPdata[,c(1:4,6)]
w.uncertainty <- cbind(w.uncertainty.M[,c(2,16)],w.uncertainty.B[,16],w.uncertainty.T[,16],w.uncertainty.S[,16])
colnames(w.uncertainty) <- c("Date","Manufacturing","Construction","Trade","Services")
w.uncertainty[,-1] <- scale(w.uncertainty[,-1])

w.uncertainty$Dispersion <- sapply(w.uncertainty$Date, function(x) weighted.mean(w.uncertainty[which(w.uncertainty$Date==x),c(2:5)], 
                                                                           weights[weights$Date==x,-1],na.rm=TRUE))
```

```{r experrors1, eval=FALSE, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
##---------------------##
##Expectations Errors--
##---------------------##
calc_errors <- function(data) {
    #remove duplicates
    dups <- data[duplicated(data[,c("id","surveyQ")]) | duplicated(data[,c("id","surveyQ")], fromLast = TRUE),]
    data <- data[!duplicated(data[,c("id","surveyQ")]),]
    
    #Compare the expectations of firms in Q7P (forward-looking) in period t to the realisations in Q7A in period t+1.
    #see example survey questions
    exp.error <- function(temp) { #calculate errors for each respondent
        #merge to create easier format
        error <- merge(datums,temp,by.x="Date",by.y="surveyQ", all.x=TRUE)
        for(t in 1:nrow(error)) {
            error$eQ2[t]  <- error$Q2A[(t+1)] - error$Q2P[t]
            error$eQ3[t]  <- error$Q3A[(t+1)] - error$Q3P[t]
            error$eQ4[t]  <- error$Q4A[(t+1)] - error$Q4P[t]
            error$eQ5[t]  <- error$Q5A[(t+1)] - error$Q5P[t]
            error$eQ6[t]  <- error$Q6A[(t+1)] - error$Q6P[t]
        }
        error <- error[,c(2,7,19:23)]
        error <- error[rowSums(is.na(error[,3:7]))!=5, ]
        return(error)
    }
    
    errors <- data.frame()
    for(i in levels(data$id)){
        errors <- rbind(errors, exp.error(data[which(data$id==i),])) 
    }
    #errors <- rbind(errors,sapply(head(levels(data$id),1), function(i) exp.error(data[which(data$id==i),]) ) )
    return(errors)
}

#Save for speed
m_errors <- calc_errors(BER[BER$Sector=="Manufacturing",])
write.csv2(m_errors,"Manufacturing_errors.csv")

b_errors <- calc_errors(BER[BER$Sector=="Construction",])
write.csv2(b_errors,"Building_errors.csv")

t_errors <- calc_errors(BER[BER$Sector=="Trade",])
write.csv2(t_errors,"Trade_errors.csv")

s_errors <- calc_errors(BER[BER$Sector=="Services",])
write.csv2(s_errors,"Services_errors.csv")
```

```{r experrors2, echo=FALSE, results='hide', message=FALSE, warning=FALSE, cache = TRUE}
#Read for speed
m_errors <- read.csv2("Manufacturing_errors.csv", header=TRUE)[,-1]
m_errors$Datum <- as.Date(m_errors$Datum)
b_errors <- read.csv2("Building_errors.csv", header=TRUE)[,-1]
b_errors$Datum <- as.Date(b_errors$Datum)
t_errors <- read.csv2("Trade_errors.csv", header=TRUE)[,-1]
t_errors$Datum <- as.Date(t_errors$Datum)
s_errors <- read.csv2("Services_errors.csv", header=TRUE)[,-1]
s_errors$Datum <- as.Date(s_errors$Datum)
errors <- rbind(m_errors,b_errors,t_errors,s_errors)

calc_uncert.ee <- function(data) {
    idio.errors <- aggregate(data[,-1:-2], by=list(data$Datum), FUN=se)
    #idio.errors[,2:6] <- scale(idio.errors[,2:6])
    idio.errors$idio <- rowMeans(idio.errors[,-1:-2],na.rm = TRUE, dims = 1)
    idio.errors$idio <- na.approx(idio.errors$idio,na.rm=FALSE)
    
    agg.errors <- aggregate(data[,-1:-2], by=list(data$Datum), FUN= function(x) {mean(x, na.rm = TRUE)^2})
    #agg.errors[,2:6] <- scale(agg.errors[,2:6])
    agg.errors$aggregate <- rowMeans(agg.errors[,-1:-2],na.rm = TRUE, dims = 1)
    agg.errors$aggregate <- na.approx(agg.errors$aggregate,na.rm=FALSE)
    
    #total.errors <- aggregate(data[,-1:-2], by=list(data$Datum), FUN= function(x) {sum(x^2, na.rm = TRUE)*mean(x, na.rm = TRUE)/sum(x, na.rm = TRUE)})
    #total.errors[,2:6] <- scale(total.errors[,2:6])
    #total.errors$total <- rowMeans(total.errors[,-1:-2],na.rm = TRUE, dims = 1)
    #total.errors$total  <- na.approx(total.errors$total,na.rm=FALSE)
    
    exp.errors <- cbind(idio.errors[,c(1,7)],agg.errors[,7])
    colnames(exp.errors) <- c("Date","Uncert_Idiosyncratic","Uncert_Aggregate")
    exp.errors$Date <- as.Date(exp.errors$Date)
    exp.errors <- merge(datums,exp.errors,by.x="Datum",by.y="Date", all=TRUE)
    return(exp.errors)
}

calc_wuncert.ee <- function(data) {
    ##Weighted versions
    weeg.3 <- function(data) {  #calculate weighted standard deviation for each quarter for all columns
        temp <- cbind(factor=data$factor,data$factor*data[,3:ncol(data)])
        xbar <- colSums(temp, na.rm=TRUE, dims = 1)/
            sapply(colnames(temp), function(x) sum(temp$factor[!is.na(temp[colnames(temp) == x])]))
        temp <- data[,-1]
        #this is the weighted standard devation: sum[wi*(xi-xbar)^2]/sum(wi) 
        idio <- sqrt(sapply(colnames(temp), function(x) sum((temp[,x]-xbar[x])*(temp[,x]-xbar[x])*temp$factor,na.rm=TRUE))/
                        sapply(colnames(temp), function(x) sum(temp$factor[!is.na(temp[colnames(temp) == x])],na.rm=TRUE))) 
        aggr <- sapply(colnames(temp), function(x) xbar[x]*xbar[x]) 
        ind <- cbind(idio,aggr)
        return(ind)
    }
    w.errors <- as.data.frame(t(sapply(datums$Datum, function(kwartaal) weeg.3(data[data$Datum==kwartaal,]))))
    w.errors <- cbind(datums$Datum,w.errors)
    colnames(w.errors) <- c("Date","Idio.factor","Idio.Q2","Idio.Q3","Idio.Q4","Idio.Q5","Idio.Q6",
                            "Aggr.factor","Aggr.Q2","Aggr.Q3","Aggr.Q4","Aggr.Q5","Aggr.Q6")
    w.errors[w.errors==0] <- NA
    w.errors[,-1] <- scale(w.errors[,-1])
    w.errors$Idio <- rowMeans(w.errors[,3:7],na.rm = TRUE, dims = 1)
    w.errors$Aggr <- rowMeans(w.errors[,9:13],na.rm = TRUE, dims = 1)
    w.errors[,14:15] <- na.approx(w.errors[,14:15],na.rm=FALSE)
    w.errors <- w.errors[,c(1,14:15)]
    return(w.errors)
}

uncert_error.M <- calc_uncert.ee(m_errors)
w.uncert_error.M <- calc_wuncert.ee(m_errors)

uncert_error.B <- calc_uncert.ee(b_errors)
w.uncert_error.B <- calc_wuncert.ee(b_errors)

uncert_error.T <- calc_uncert.ee(t_errors)
w.uncert_error.T <- calc_wuncert.ee(t_errors)

uncert_error.S <- calc_uncert.ee(s_errors)
w.uncert_error.S <- calc_wuncert.ee(s_errors)

uncert_error <- calc_uncert.ee(errors)

#----------------------------------------------------------
##Weighted versions
weights <- GDPdata[,c(1:4,6)]
idio.errors <- cbind(w.uncert_error.M[,c(1,2)],w.uncert_error.B[,2],w.uncert_error.T[,2],w.uncert_error.S[,2])
colnames(idio.errors) <- c("Date","Manufacturing","Construction","Trade","Services")

aggr.errors <- cbind(w.uncert_error.M[,c(1,3)],w.uncert_error.B[,3],w.uncert_error.T[,3],w.uncert_error.S[,3])
colnames(aggr.errors) <- c("Date","Manufacturing","Construction","Trade","Services")

#create weighted means by GDP share
idio.errors$Idio.errors <- sapply(idio.errors$Date, function(x) weighted.mean(idio.errors[which(idio.errors$Date==x),c(2:5)], 
                                                               weights[weights$Date==x,-1],na.rm=TRUE))
aggr.errors$Aggr.errors <- sapply(aggr.errors$Date, function(x) weighted.mean(aggr.errors[which(aggr.errors$Date==x),c(2:5)], 
                                                                              weights[weights$Date==x,-1],na.rm=TRUE))

w.uncert_error <- cbind(w.uncertainty[,c(1,6)],idio.errors[,6],aggr.errors[,6])
colnames(w.uncert_error) <- c("Date","Dispersion","Idiosyncratic","Aggregate")

uncert_error <- cbind(uncertainty[,c(2,6)],uncert_error[,3:4])
colnames(uncert_error) <- c("Date","Dispersion","Idiosyncratic","Aggregate")
uncert_error[,-1] <- na.approx(uncert_error[,-1])
uncert_error[,-1] <- scale(uncert_error[,-1])
```

Figure 3.9 illustrates the weighted sectoral Dispersion, Idiosyncratic and Aggregate uncertainty indicators. Indicators of uncertainty are quite volatile by construction [@Girardi2015]. In many cases the individual indicators for a sector are not significantly correlated, as reported in Table 3.8 below. As a result, they do not always seem to point to the same periods of heightened uncertainty. For instance, the Dispersion and Aggregate uncertainty indicators for the Manufacturing sector show heightened uncertainty in 1998, during the recession, whereas the Idiosyncratic uncertainty indicator does not. In the Construction sector the Dispersion and Aggregate indicators point to heightened uncertainty in 2009 during the recession, whereas the Idiosyncratic uncertainty indicator does not. 

The disagreement is due to different calculation methods used to construct the proxies. The Dispersion indicator measures the disagreement in expectations, expressed as a share of the natural dispersion. The Aggregate and Idiosyncratic indicators measure respectively the average and standard deviation of realised expectation errors. Aggregate uncertainty will increase if more firms make similar and larger errors, while Idiosyncratic uncertainty will decrease if more firms make similar expectation errors.

```{r figure3.9, echo=FALSE, warning=FALSE, message=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="Weighted Sectoral Uncertainty Indicators"}
index_plot <- cbind(w.uncert_error.M,w.uncertainty.M[,16])
index_plot[,-1] <- scale(index_plot[,-1])
colnames(index_plot) <- c("Date","Idiosyncratic","Aggregate","Dispersion")
index_plot <- melt(index_plot, id="Date")  # convert to long format
g1 <- ggplot(index_plot, aes(x=Date,y=value,group=variable,colour=variable)) 
g1 <- g1 + geom_line()
g1 <- g1 + theme(legend.title=element_blank())
g1 <- g1 + ggtitle("Manufacturing") 
g1 <- g1 + ylab("Indicator") + xlab("")
g1 <- g1 + theme(legend.position="none")
g1 <- g1 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g1 <- g1 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))

index_plot <- cbind(w.uncert_error.B,w.uncertainty.B[,16])
index_plot[,-1] <- scale(index_plot[,-1])
colnames(index_plot) <- c("Date","Idiosyncratic","Aggregate","Dispersion")
index_plot <- melt(index_plot, id="Date")  # convert to long format
g2 <- ggplot(index_plot, aes(x=Date,y=value,group=variable,colour=variable)) 
g2 <- g2 + geom_line()
g2 <- g2 + theme(legend.title=element_blank())
g2 <- g2 + ggtitle("Construction") 
g2 <- g2 + ylab("") + xlab("")
g2 <- g2 + theme(legend.position="none")
g2 <- g2 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g2 <- g2 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))

index_plot <- cbind(w.uncert_error.T,w.uncertainty.T[,16])
index_plot[,-1] <- scale(index_plot[,-1])
colnames(index_plot) <- c("Date","Idiosyncratic","Aggregate","Dispersion")
index_plot <- melt(index_plot, id="Date")  # convert to long format
g3 <- ggplot(index_plot, aes(x=Date,y=value,group=variable,colour=variable)) 
g3 <- g3 + geom_line()
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + ggtitle("Trade") 
g3 <- g3 + ylab("Indicator") + xlab("")
g3 <- g3 + theme(legend.position="bottom",plot.margin=unit(c(-0.5,0.4,0,0.4), "cm"))
g3 <- g3 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g3 <- g3 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))

index_plot <- cbind(w.uncert_error.S[-1:-52,],w.uncertainty.S[-1:-52,16])
index_plot[,-1] <- scale(index_plot[,-1])
colnames(index_plot) <- c("Date","Idiosyncratic","Aggregate","Dispersion")
index_plot <- melt(index_plot, id="Date")  # convert to long format
g4 <- ggplot(index_plot, aes(x=Date,y=value,group=variable,colour=variable)) 
g4 <- g4 + geom_line()
g4 <- g4 + theme(legend.title=element_blank())
g4 <- g4 + ggtitle("Services") 
g4 <- g4 + ylab("") + xlab("")
g4 <- g4 + theme(legend.position="bottom",plot.margin=unit(c(-0.5,0.4,0,0.4), "cm"))
g4 <- g4 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g4 <- g4 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))

library(gridExtra)
grid.arrange(g1, g2, g3, g4, ncol=2, nrow =2)
```

Figure 3.10 illustrates the three aggregated weighted uncertainty indicators, with recessionary periods shaded. As with the sectoral proxies, the indicators are relatively volatile and are not significantly correlated with each other, as reported in Table 3.7 below. Consequently, the indicators do not generally point to the same periods of heightened uncertainty. The Dispersion indicator seems to follow the strongest anti-cyclical pattern, with spikes during the recessionary periods. The Idiosyncratic indicator tends to decrease as the economy enters a recessionary period and then to increase towards the end of the recession and into the start of the recovery phase. This is probably because the majority of firms expected poorer general conditions with more certainty as the recession took hold. Uncertainty about the future then increases around the trough, as expectations became more disperse and more uncertain. The Aggregate indicator points to relatively fewer spikes in uncertainty, when firms were making similar and larger errors in their forecasts. The result for the unweighted indicators are similar to the weighted versions, as was the case for the confidence indicators.

```{r figure3.10, echo=FALSE, warning=FALSE, message=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="Weighted Uncertainty Indicators"}
index_plot <- w.uncert_error 
g <- ggplot(index_plot) 
g <- g + geom_line(aes(x=Date, y=Aggregate, colour="Aggregate"), size = 1)
g <- g + geom_line(aes(x=Date, y=Idiosyncratic, colour="Idiosyncratic"), size = 1)
g <- g + geom_line(aes(x=Date, y=Dispersion, colour="Dispersion"), size = 1)
g <- g + labs(color="Legend text")
g <- g + geom_rect(data=recessions.df, aes(xmin=Peak, xmax=Trough, ymin=-Inf, ymax=+Inf), fill='grey', alpha=0.5)
g <- g + ylab("Indicator") + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank()) 
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"), expand=c(0,0),
                      limits = as.Date(c("1990-12-31", NA)))
g <- g + theme(legend.position="bottom")
g
```

The following section tests validity more formally, by comparing the uncertainty indicators to alternative measures of uncertainty, the EPU and the SAVI, and evaluates the indicators in terms of their correlation with real GDP growth. A combined indicator is then constructed from all 5 proxies, which turns out to perform better than the individual indicators. The relationships are analysed for the aggregate variables, as well as for each sector separately. The advantage of also looking at specific sectors separately is that general equilibrium effects are mitigated. The wait-and-see effect may be dampened by general equilibrium price adjustments (e.g. at least some firms will continue hiring if wages adjust in equilibrium). The focus on sectoral indicators offers a better chance of detecting the wait-and-see effect [@Bachmann2010].

###Validity Tests and Evaluation
This section compares the survey-based uncertainty indicators and the two alternative indicators of uncertainty in South Africa, the EPU and the SAVI. Their correlations with real GDP growth are also evaluated. The results presented below indicate that the combined uncertainty indicator exhibits a higher correlation with movements in real output growth than the separate components. 

####Correlations between uncertainty indicators and real GDP growth
Figure 3.11 illustrates the two alternative indicators, as well as the combined overall Uncertainty indicator, which is calculated as the first principal component of the 5 standardised uncertainty indicators. The overall combined indicator seems particularly plausible as a proxy for macroeconomic uncertainty, as a number of large spikes coincide with periods when uncertainty in South Africa was thought to be relatively high. For instance, Uncertainty was relatively high during South Africa's Democratic transition up to 1994. There was quite a large spike, mainly in policy uncertainty, during the adoption of the new constitution in 1996. Other spikes coincide with the East Asian and Russian crises and the related recessionary period in 1998, the ambiguous period in 2003, the global financial crisis in 2008 and the subsequent recession, and the start of the current recessionary period in 2014.

```{r pca, echo=FALSE, warning=FALSE, message=FALSE, cache = TRUE}
uncert_indices <- cbind(w.uncert_error,GDPdata$IMF_Uncertainty, GDPdata$SAVI,GDPgrowth4$RGDP)
colnames(uncert_indices) <-c("Date","Dispersion","Idiosyncratic","Aggregate","EPU","SAVI","RGDP_Growth")
uncert_indices[,-1] <- scale(uncert_indices[,-1])
un <- uncert_indices #un <- na.locf(uncert_indices)
un[is.na(un)] <- 0
#uncert_indices$Uncertainty <- rowMeans(uncert_indices[,c(2:6)],na.rm = TRUE)
uncert_indices$Uncertainty <- princomp(un[,c(2:6)])$scores[,1]
uncert_indices <- uncert_indices[,c(1:6,8,7)]

```

```{r figure3.11, echo=FALSE, warning=FALSE, message=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="Weighted Uncertainty Indicators"}
index_plot <- uncert_indices
g <- ggplot(index_plot) 
g <- g + geom_line(aes(x=Date, y=EPU, colour="EPU"), size = 0.9)
g <- g + geom_line(aes(x=Date, y=SAVI, colour="SAVI"), size = 0.9)
g <- g + geom_line(aes(x=Date, y=Uncertainty, colour="Uncertainty"), size = 1)
g <- g + labs(color="Legend text")
g <- g + geom_rect(data=recessions.df, aes(xmin=Peak, xmax=Trough, ymin=-Inf, ymax=+Inf), fill='grey', alpha=0.5)
g <- g + ylab("Indicator") + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank()) 
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"), expand=c(0,0),
                      limits = as.Date(c("1990-12-31", NA)))
g <- g + theme(legend.position="bottom")
g

```

Table 3.7 reports the contemporaneous correlations of the indicators and real GDP growth. The Dispersion, EPU and overall Uncertainty indicators exhibit significant negative correlations with real GDP growth. These indicators are contemporaneously counter-cyclical, as is the case for the majority of the uncertainty indicators in the international literature [e.g. @Bloom2014]. The Idiosyncratic uncertainty indicator does not exhibit the negative correlation with real GDP growth found in @Bachmann2010 and @Bachmann2013.

The individual indicators are not significantly correlated with each other. This is not too surprising as they capture different types of uncertainty [@Leduc2015]. Survey-based measures capture the opinions of key agents in the economy and are driven by changes in firm-level uncertainty. Due to their qualitative nature, however, they are poorly equipped to fully capture large increases in uncertainty during extreme events [@Bachmann2013]. The SAVI captures broad uncertainty in financial markets, but is derived from a specific segment of firms that are publicly traded, while the EPU is specifically focused on policy uncertainty. This motivates the use of a combined overall indicator, which captures different types of uncertainty from more than one source. The combined Uncertainty indicator has the highest correlation (and largest factor loading) with the SAVI. It has a significant positive correlation with the Dispersion and EPU indicators, and a negative correlation with Idiosyncratic uncertainty. 

```{r table3.7, echo=FALSE, results='asis', warning=FALSE, message=FALSE, cache = TRUE}
source("corstarsl.R")
xt <- xtable(corstarsl(uncert_indices[,-1]), caption="Correlations in Levels")
print(xt, "latex",comment=FALSE, caption.placement = getOption("xtable.caption.placement", "top"), scalebox = 0.8)

```

Figure 3.12 illustrates the cross-correlograms for the uncertainty indicators and real GDP growth. All the indicators exhibit a significant negative correlation with real GDP growth, albeit at different horizons. All the indicators seem to lead changes in real GDP growth, except the Idiosyncratic indicator, which lags real GDP growth.[^32]

[^32]: It is possible that there is a structural explanation for the different timing of the relationship between Idiosyncratic uncertainty and real GDP growth. For instance, South African firms may react later to events like recessions than US firms (i.e. they may be less forward-looking). Alternatively, it could be that something like the growth effect is in operation in South Africa. There may also be problems with the survey data, either in terms of errors or unrepresentativeness.

```{r figure3.12, echo=FALSE, warning=FALSE, message=FALSE, cache = TRUE, fig.height=7.5, fig.width=7.5, fig.cap="Cross-correlograms of uncertainty indicators and real GDP growth"}
Dispersion <- uncert_indices[,2]
Idiosyncratic <- uncert_indices[,3]
Aggregate <- uncert_indices[,4]
EPU <- uncert_indices[,5] 
SAVI <- uncert_indices[,6] 
Uncertainty <- uncert_indices[,7]
RGDP_Growth <- conf_indices[,6]

par(mfrow=c(3,2))
ccf(Dispersion, RGDP_Growth, na.action = na.pass, ylim=c(-0.5, 0.5))
ccf(Idiosyncratic, RGDP_Growth, na.action = na.pass, ylim=c(-0.5, 0.5))
ccf(Aggregate, RGDP_Growth, na.action = na.pass, ylim=c(-0.5, 0.5))
#par(mfrow=c(2,2))
ccf(EPU, RGDP_Growth, na.action = na.pass, ylim=c(-0.5, 0.5))
ccf(SAVI, RGDP_Growth, na.action = na.pass, ylim=c(-0.5, 0.5))
ccf(Uncertainty, RGDP_Growth, na.action = na.pass, ylim=c(-0.5, 0.5))
```

Table 3.8 reports the contemporaneous correlations for the sectoral indicators and sectoral real GDP growth. The overall Uncertainty indicator for each sector is the first principal component of the 3 survey-based measures. Only in some cases are the different uncertainty indicators significantly negative correlated with contemporaneous real sectoral GDP growth. 

```{r table3.8, echo=FALSE, results='asis', warning=FALSE, message=FALSE, cache = TRUE}
#Sectoral Analysis
manufac2 <- cbind(w.uncert_error.M,w.uncertainty.M[,16], GDPgrowth4$Manufacturing)
colnames(manufac2) <- c("Date","Idiosyncratic","Aggregate","Dispersion","RGDP_Growth")
manufac2[,2:4] <- scale(manufac2[,2:4])
#manufac$Uncertainty <- rowMeans(manufac[,c(2:4)],na.rm = TRUE)
manufac2 <- manufac2[-95,]
manufac2$Uncertainty <- princomp(na.locf(manufac2[,2:4]))$scores[,1]
manufac2 <- manufac2[,c(1:4,6,5)]

construct2 <- cbind(w.uncert_error.B,w.uncertainty.B[,16], GDPgrowth4$Construction)
colnames(construct2) <- c("Date","Idiosyncratic","Aggregate","Dispersion","RGDP_Growth")
construct2[,2:4] <- scale(construct2[,2:4])
#construct$Uncertainty <- rowMeans(construct[,c(2:4)],na.rm = TRUE)
construct2 <- construct2[c(-1:-5,-95),] #un <- na.locf(uncert_indices)
#un[is.na(un)] <- 0
construct2$Uncertainty <- princomp(na.locf(construct2[,2:4]))$scores[,1]
construct2 <- construct2[,c(1:4,6,5)]

trade2 <- cbind(w.uncert_error.T,w.uncertainty.T[,16], GDPgrowth4$Trade)
colnames(trade2) <- c("Date","Idiosyncratic","Aggregate","Dispersion","RGDP_Growth")
trade2[,2:4] <- scale(trade2[,2:4])
#trade$Uncertainty <- rowMeans(trade[,c(2:4)],na.rm = TRUE)
trade2 <- trade2[c(-1,-95),] #un <- na.locf(uncert_indices)
#un[is.na(un)] <- 0
trade2$Uncertainty <- princomp(na.locf(trade2[,2:4]))$scores[,1]
trade2 <- trade2[,c(1:4,6,5)]

services2 <- cbind(w.uncert_error.S,w.uncertainty.S[,16], GDPgrowth4$Services)
colnames(services2) <- c("Date","Idiosyncratic","Aggregate","Dispersion","RGDP_Growth")
services2[,2:4] <- scale(services2[,2:4])
#services$Uncertainty <- rowMeans(services[,c(2:4)],na.rm = TRUE)
services2 <- services2[c(-1:-53,-95),] #un <- na.locf(uncert_indices)
#un[is.na(un)] <- 0
services2$Uncertainty <- princomp(na.locf(services2[,2:4]))$scores[,1]
services2 <- services2[,c(1:4,6,5)]

#Check correlations
source("corstarsl.R")
xt1 <- cbind(corstarsl(manufac2[,-1]),corstarsl(construct2[,-1]))
xt2 <- cbind(corstarsl(trade2[,-1]),corstarsl(services2[,-1]))
xt1 <- sapply(xt1,as.character)
xt2 <- sapply(xt2,as.character)
xt1[1,] <- c("Idiosyncratic","Aggregate","Dispersion","Uncertainty","Idiosyncratic","Aggregate","Dispersion","Uncertainty")
xt2[1,] <- c("Idiosyncratic","Aggregate","Dispersion","Uncertainty","Idiosyncratic","Aggregate","Dispersion","Uncertainty")
colnames(xt1) <- c(" "," ","Manufacturing"," "," "," ","Construction"," ")
colnames(xt2) <- c(" "," ","Trade"," "," "," ","Services"," ")
row.names(xt1) <- c("Idiosyncratic","Aggregate","Dispersion","Uncertainty","RGDP")
row.names(xt2) <- c("Idiosyncratic","Aggregate","Dispersion","Uncertainty","RGDP")

xt <- xtable(xt1, caption="Correlations in Levels")
print(xt, "latex",comment=FALSE, caption.placement = getOption("xtable.caption.placement", "top"), scalebox = 0.7)
xt <- xtable(xt2)
print(xt, "latex",comment=FALSE, caption.placement = getOption("xtable.caption.placement", "top"), scalebox = 0.75)
```

Figure 3.13 illustrates the cross-correlograms for the Manufacturing indicators and real GDP growth in the Manufacturing sector. The correlograms are similar to the aggregated results reported above, where the Dispersion and Aggregate measures have significant negative relationship with real GDP growth. The results for the other three sectors do not indicate a consistent negative relationship between any of the uncertainty indicators and real GDP growth. This is somewhat puzzling, as the wait-and-see effect is expected to show up more clearly at sectoral level [@Bachmann2010; @INIS2014].

```{r figure3.13, echo=FALSE, warning=FALSE, message=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="Cross-correlograms of Manufacturing uncertainty indicators and real GDP growth"}
calc_ccf <- function(data) {
    Idiosyncratic <- data[,2]
    Aggregate <- data[,3]
    Dispersion <- data[,4]
    Uncertainty <- data[,5]
    RGDP_Growth <- data[,6]
    
    par(mfrow=c(2,2))
    ccf(Idiosyncratic, RGDP_Growth, na.action = na.pass, ylim=c(-0.5, 0.5))
    ccf(Aggregate, RGDP_Growth, na.action = na.pass, ylim=c(-0.5, 0.5))
    ccf(Dispersion, RGDP_Growth, na.action = na.pass, ylim=c(-0.5, 0.5))
    ccf(Uncertainty, RGDP_Growth, na.action = na.pass, ylim=c(-0.5, 0.5))
}

calc_ccf(manufac2)
#calc_ccf(construct)
#calc_ccf(trade)
#calc_ccf(services)
```

This section has presented 3 survey-based indicators of uncertainty, as well as two additional popular proxies from the literature: stock market volatility and the news-based EPU created by @Hlatshwayo2016. All the indicators appear to be counter-cyclical in the sense that they exhibit a significant negative correlation with real GDP growth, albeit at different horizons. Most of the indicators seem to lead changes in real GDP growth. None of the indicators are a perfect measure of an elusive and multidimensional phenomenon, but all of them may contribute to our understanding of uncertainty [@Bachmann2013]. The 5 indicators were combined to form an overall Uncertainty indicator, similar to @Baker2013 and @Redl2015, to reflect different sources of uncertainty from the different proxies. This combined indicator appeared to be a plausible indicator of uncertainty in South Africa, reflecting key economic events. It also tracked real GDP growth rates more closely than any of the individual components separately.

##The Relationship between Business Sentiment and Real Economic Activity
The secondary aim of this chapter is to examine the relationship between business sentiment and real economic activity in South Africa, including the timing of this relationship and the extent to which correlation is conditional on other economic variables. This section tests the hypothesis that there is significant comovement between the sentiment indicators and real GDP growth, using the standard agnostic methods. Granger causality tests are used to illuminate the timing of the relationships between the indicators and real output growth. Simple bivariate VARs are then estimated to provide evidence on the dynamic effects of confidence and uncertainty shocks on the economy.

###Granger causality tests
Granger causality tests are often performed when investigating the comovement among variables. This test determines whether one time series is useful in forecasting another, by measuring the ability of lagged values of a time series to predict the future values of another time series. A time series $Z$ is said to Granger-cause $Y$ if it can be shown that the $Z$ values provide statistically significant information of future values of $Y$. If the hypothesis that a sentiment indicator does not Granger-cause an economic variable is rejected, it implies that past values of sentiment provide significant information for the economic variable in addition to its own history.

Table 3.9 reports the results for Granger causality tests for the confidence indicators and real GDP growth. The results suggest that the lagged values of all three survey-based confidence indicators significantly predict real GDP growth, with limited evidence of Granger-causality in the reverse direction. In other words, the results suggest that all three survey-based confidence indicators contain relevant information for the prediction of output growth. This implies that the survey-based measures exhibit a leading relationship with real GDP growth.

```{r vars, echo=FALSE, results='hide', message=FALSE, warning=FALSE, cache = TRUE}
##=================================================
##-------------VAR Analysis------------------------
##=================================================
calc_var <- function(data) {
    vardat <- data
    infocrit <- VARselect(vardat, lag.max = 12, type = "const")
    k_aic <- infocrit$selection[1]
    k_hq  <- infocrit$selection[2]
    k_sic <- infocrit$selection[3]
    k <- min(k_aic,k_sic,k_hq)
    var_model <- VAR(vardat,p=k,type="const")
    return(var_model)
}

var1 <- calc_var(cbind(Activity,RGDP_Growth))
var2 <- calc_var(cbind(Confidence, RGDP_Growth))
var3 <- calc_var(cbind(BER_BCI, RGDP_Growth))
var4 <- calc_var(cbind(SACCI_BCI, RGDP_Growth))
```

```{r table3.9, echo=FALSE, results='asis', warning=FALSE, message=FALSE, cache = TRUE}
G <- data.frame()
G[1,1] <- causality(var1,cause = "Activity")$Granger[4]
G[1,2] <- as.numeric(as.character(causality(var1,cause = "Activity")$Granger[1]))
G[1,3] <- as.numeric(as.character(causality(var1,cause = "Activity")$Granger[3]))
G[2,1] <- causality(var1,cause = "RGDP_Growth")$Granger[4]
G[2,2] <- as.numeric(as.character(causality(var1,cause = "RGDP_Growth")$Granger[1]))
G[2,3] <- as.numeric(as.character(causality(var1,cause = "RGDP_Growth")$Granger[3]))

G[3,1] <- causality(var2,cause = "Confidence")$Granger[4]
G[3,2] <- as.numeric(as.character(causality(var2,cause = "Confidence")$Granger[1]))
G[3,3] <- as.numeric(as.character(causality(var2,cause = "Confidence")$Granger[3]))
G[4,1] <- causality(var2,cause = "RGDP_Growth")$Granger[4]
G[4,2] <- as.numeric(as.character(causality(var2,cause = "RGDP_Growth")$Granger[1]))
G[4,3] <- as.numeric(as.character(causality(var2,cause = "RGDP_Growth")$Granger[3]))

G[5,1] <- causality(var3,cause = "BER_BCI")$Granger[4]
G[5,2] <- as.numeric(as.character(causality(var3,cause = "BER_BCI")$Granger[1]))
G[5,3] <- as.numeric(as.character(causality(var3,cause = "BER_BCI")$Granger[3]))
G[6,1] <- causality(var3,cause = "RGDP_Growth")$Granger[4]
G[6,2] <- as.numeric(as.character(causality(var3,cause = "RGDP_Growth")$Granger[1]))
G[6,3] <- as.numeric(as.character(causality(var3,cause = "RGDP_Growth")$Granger[3]))

G[7,1] <- causality(var4,cause = "SACCI_BCI")$Granger[4]
G[7,2] <- as.numeric(as.character(causality(var4,cause = "SACCI_BCI")$Granger[1]))
G[7,3] <- as.numeric(as.character(causality(var4,cause = "SACCI_BCI")$Granger[3]))
G[8,1] <- causality(var4,cause = "RGDP_Growth")$Granger[4]
G[8,2] <- as.numeric(as.character(causality(var4,cause = "RGDP_Growth")$Granger[1]))
G[8,3] <- as.numeric(as.character(causality(var4,cause = "RGDP_Growth")$Granger[3]))

G[,2:3] <- round(G[,2:3],3)
mystars <- ifelse(G[,3] < .01, "***", ifelse(G[,3] < .05, "** ", ifelse(G[,3] < .1, "* ", " ")))
Gnew <- matrix(paste(G[,2], mystars, sep=""), ncol=1) 
G[,1] <- sub(".*: ", "", G[,1])
G[,2] <- Gnew
colnames(G) <- c("Granger causality H0:","statistic","p-value")

xt <- xtable(G, caption="Granger causality tests: Aggregate Confidence")
print(xt, "latex", include.rownames=FALSE,comment=FALSE, caption.placement = getOption("xtable.caption.placement", "top"), 
      scalebox = 0.8)
```

Table 3.10 reports the results of the Granger causality tests for the sectoral confidence indicators and their corresponding real sectoral GDP growth rates. The results are similar to those for the aggregate indicators, except for the trade sector (i.e. wholesale, retail and motor vehicles), where lagged values of real GDP growth significantly predicts all three survey-based confidence indicators. This implies that the confidence indicators for the trade sector are lagging indicators for real GDP growth in that sector.

```{r table3.10, echo=FALSE, results='asis', warning=FALSE, message=FALSE, cache = TRUE}
calc_sectoralvar <- function(data, serv=0) {
    Activity <- data[,2]
    Confidence <- data[,3]
    BER_BCI <- data[,4]
    RGDP_Growth <- data[,5]
    
    var1 <- calc_var(cbind(Activity,RGDP_Growth))
    var2 <- calc_var(cbind(Confidence, RGDP_Growth))
    var3 <- calc_var(cbind(BER_BCI, RGDP_Growth))

    ##Granger causality tests
    G <- data.frame()
    G[1,1] <- causality(var1,cause = "Activity")$Granger[4]
    G[1,2] <- as.numeric(as.character(causality(var1,cause = "Activity")$Granger[1]))
    G[1,3] <- as.numeric(as.character(causality(var1,cause = "Activity")$Granger[3]))
    G[2,1] <- causality(var1,cause = "RGDP_Growth")$Granger[4]
    G[2,2] <- as.numeric(as.character(causality(var1,cause = "RGDP_Growth")$Granger[1]))
    G[2,3] <- as.numeric(as.character(causality(var1,cause = "RGDP_Growth")$Granger[3]))
    
    G[3,1] <- causality(var2,cause = "Confidence")$Granger[4]
    G[3,2] <- as.numeric(as.character(causality(var2,cause = "Confidence")$Granger[1]))
    G[3,3] <- as.numeric(as.character(causality(var2,cause = "Confidence")$Granger[3]))
    G[4,1] <- causality(var2,cause = "RGDP_Growth")$Granger[4]
    G[4,2] <- as.numeric(as.character(causality(var2,cause = "RGDP_Growth")$Granger[1]))
    G[4,3] <- as.numeric(as.character(causality(var2,cause = "RGDP_Growth")$Granger[3]))
    
    if(serv==0) {
        G[5,1] <- causality(var3,cause = "BER_BCI")$Granger[4]
        G[5,2] <- as.numeric(as.character(causality(var3,cause = "BER_BCI")$Granger[1]))
        G[5,3] <- as.numeric(as.character(causality(var3,cause = "BER_BCI")$Granger[3]))
        G[6,1] <- causality(var3,cause = "RGDP_Growth")$Granger[4]
        G[6,2] <- as.numeric(as.character(causality(var3,cause = "RGDP_Growth")$Granger[1]))
        G[6,3] <- as.numeric(as.character(causality(var3,cause = "RGDP_Growth")$Granger[3]))
    }    
    G[,2:3] <- round(G[,2:3],3)
    mystars <- ifelse(G[,3] < .01, "***", ifelse(G[,3] < .05, "** ", ifelse(G[,3] < .1, "* ", " ")))
    Gnew <- matrix(paste(G[,2], mystars, sep=""), ncol=1) 
    G[,1] <- sub(".*: ", "", G[,1])
    G[,2] <- Gnew
    colnames(G) <- c("Granger causality H0:","statistic","p-value")
    
    return(G)
}

G_manu <- calc_sectoralvar(manufac)
G_build <- calc_sectoralvar(construct[-1:-5,])
G_trade <- calc_sectoralvar(trade[-1,])
G_serv <- calc_sectoralvar(services[-1:-53,],1)
G_serv <- rbind(G_serv, c("BER_BCI do not Granger-cause RGDP_Growth","",""), 
                        c("RGDP_Growth do not Granger-cause BER_BCI","",""))
                
G_sector <- cbind(G_manu[,1:2],G_build[,2],G_trade[,2],G_serv[,2])
colnames(G_sector)[2:5] <- c("Manufacturing", "Construction","Trade","Services")

xt <- xtable(G_sector, caption="Granger causality tests: Sectoral Confidence")
print(xt, "latex", include.rownames=FALSE,comment=FALSE, caption.placement = getOption("xtable.caption.placement", "top"), 
      scalebox = 0.8)
```

Table 3.11 reports the results of Granger causality tests for the uncertainty indicators and real GDP growth. The results provide little evidence of Granger-causality for the indicators and real GDP growth in either direction. The exceptions are real GDP growth Granger-causing Idiosyncratic uncertainty and Aggregate uncertainty Granger-causing real GDP growth.

```{r vars2, echo=FALSE, results='hide', message=FALSE, warning=FALSE, cache = TRUE}
calc_var <- function(data) {
    vardat <- data
    infocrit <- VARselect(vardat, lag.max = 12, type = "const")
    k_aic <- infocrit$selection[1]
    k_hq  <- infocrit$selection[2]
    k_sic <- infocrit$selection[3]
    k <- min(k_aic,k_sic,k_hq)
    var_model <- VAR(vardat,p=k,type="const")
    return(var_model)
}

var1 <- calc_var(cbind(Dispersion,RGDP_Growth)[-95,])
var2 <- calc_var(cbind(Idiosyncratic, RGDP_Growth)[-95,])
var3 <- calc_var(cbind(Aggregate, RGDP_Growth)[-95,])
var4 <- calc_var(cbind(EPU, RGDP_Growth))
var5 <- calc_var(cbind(SAVI,RGDP_Growth)[-1:-14,])
var6 <- calc_var(cbind(Uncertainty, RGDP_Growth)[-95,])
```

```{r table3.11, echo=FALSE, results='asis', warning=FALSE, message=FALSE, cache = TRUE}
##Granger causality tests
G <- data.frame()
G[1,1] <- causality(var1,cause = "Dispersion")$Granger[4]
G[1,2] <- as.numeric(as.character(causality(var1,cause = "Dispersion")$Granger[1]))
G[1,3] <- as.numeric(as.character(causality(var1,cause = "Dispersion")$Granger[3]))
G[2,1] <- causality(var1,cause = "RGDP_Growth")$Granger[4]
G[2,2] <- as.numeric(as.character(causality(var1,cause = "RGDP_Growth")$Granger[1]))
G[2,3] <- as.numeric(as.character(causality(var1,cause = "RGDP_Growth")$Granger[3]))

G[3,1] <- causality(var2,cause = "Idiosyncratic")$Granger[4]
G[3,2] <- as.numeric(as.character(causality(var2,cause = "Idiosyncratic")$Granger[1]))
G[3,3] <- as.numeric(as.character(causality(var2,cause = "Idiosyncratic")$Granger[3]))
G[4,1] <- causality(var2,cause = "RGDP_Growth")$Granger[4]
G[4,2] <- as.numeric(as.character(causality(var2,cause = "RGDP_Growth")$Granger[1]))
G[4,3] <- as.numeric(as.character(causality(var2,cause = "RGDP_Growth")$Granger[3]))

G[5,1] <- causality(var3,cause = "Aggregate")$Granger[4]
G[5,2] <- as.numeric(as.character(causality(var3,cause = "Aggregate")$Granger[1]))
G[5,3] <- as.numeric(as.character(causality(var3,cause = "Aggregate")$Granger[3]))
G[6,1] <- causality(var3,cause = "RGDP_Growth")$Granger[4]
G[6,2] <- as.numeric(as.character(causality(var3,cause = "RGDP_Growth")$Granger[1]))
G[6,3] <- as.numeric(as.character(causality(var3,cause = "RGDP_Growth")$Granger[3]))

G[7,1] <- causality(var4,cause = "EPU")$Granger[4]
G[7,2] <- as.numeric(as.character(causality(var4,cause = "EPU")$Granger[1]))
G[7,3] <- as.numeric(as.character(causality(var4,cause = "EPU")$Granger[3]))
G[8,1] <- causality(var4,cause = "RGDP_Growth")$Granger[4]
G[8,2] <- as.numeric(as.character(causality(var4,cause = "RGDP_Growth")$Granger[1]))
G[8,3] <- as.numeric(as.character(causality(var4,cause = "RGDP_Growth")$Granger[3]))

G[9,1] <- causality(var5,cause = "SAVI")$Granger[4]
G[9,2] <- as.numeric(as.character(causality(var5,cause = "SAVI")$Granger[1]))
G[9,3] <- as.numeric(as.character(causality(var5,cause = "SAVI")$Granger[3]))
G[10,1] <- causality(var5,cause = "RGDP_Growth")$Granger[4]
G[10,2] <- as.numeric(as.character(causality(var5,cause = "RGDP_Growth")$Granger[1]))
G[10,3] <- as.numeric(as.character(causality(var5,cause = "RGDP_Growth")$Granger[3]))

G[11,1] <- causality(var6,cause = "Uncertainty")$Granger[4]
G[11,2] <- as.numeric(as.character(causality(var6,cause = "Uncertainty")$Granger[1]))
G[11,3] <- as.numeric(as.character(causality(var6,cause = "Uncertainty")$Granger[3]))
G[12,1] <- causality(var6,cause = "RGDP_Growth")$Granger[4]
G[12,2] <- as.numeric(as.character(causality(var6,cause = "RGDP_Growth")$Granger[1]))
G[12,3] <- as.numeric(as.character(causality(var6,cause = "RGDP_Growth")$Granger[3]))

G[,2:3] <- round(G[,2:3],3)
mystars <- ifelse(G[,3] < .01, "***", ifelse(G[,3] < .05, "** ", ifelse(G[,3] < .1, "* ", " ")))
Gnew <- matrix(paste(G[,2], mystars, sep=""), ncol=1) 
G[,1] <- sub(".*: ", "", G[,1])
G[,2] <- Gnew
colnames(G) <- c("Granger causality H0:","statistic","p-value")

xt <- xtable(G, caption="Granger causality tests: Aggregate Uncertainty")
print(xt, "latex", include.rownames=FALSE,comment=FALSE, caption.placement = getOption("xtable.caption.placement", "top"), 
      scalebox = 0.8)
```

The results for the sectoral indices are reported in Table 3.12. The results are not consistent across the sectors. There is limited evidence of Granger-causality in both directions for a few of the indicators in the Manufacturing and Construction sectors. There is no evidence of Granger causality in the Trade sector and the Services sector Aggregate indicator seems to lag real GDP growth in that sector.

```{r table3.12, echo=FALSE, results='asis', warning=FALSE, message=FALSE, cache = TRUE}
calc_sectoralvar <- function(data) {
    Idiosyncratic <- data[,2]
    Aggregate <- data[,3]
    Dispersion <- data[,4]
    Uncertainty <- data[,5]
    RGDP_Growth <- data[,6]
    
    var1 <- calc_var(cbind(Idiosyncratic,RGDP_Growth))
    var2 <- calc_var(cbind(Aggregate, RGDP_Growth))
    var3 <- calc_var(cbind(Dispersion, RGDP_Growth))
    var4 <- calc_var(cbind(Uncertainty, RGDP_Growth))
    
    ##Granger causality tests
    G <- data.frame()
    G[1,1] <- causality(var1,cause = "Idiosyncratic")$Granger[4]
    G[1,2] <- as.numeric(as.character(causality(var1,cause = "Idiosyncratic")$Granger[1]))
    G[1,3] <- as.numeric(as.character(causality(var1,cause = "Idiosyncratic")$Granger[3]))
    G[2,1] <- causality(var1,cause = "RGDP_Growth")$Granger[4]
    G[2,2] <- as.numeric(as.character(causality(var1,cause = "RGDP_Growth")$Granger[1]))
    G[2,3] <- as.numeric(as.character(causality(var1,cause = "RGDP_Growth")$Granger[3]))
    
    G[3,1] <- causality(var2,cause = "Aggregate")$Granger[4]
    G[3,2] <- as.numeric(as.character(causality(var2,cause = "Aggregate")$Granger[1]))
    G[3,3] <- as.numeric(as.character(causality(var2,cause = "Aggregate")$Granger[3]))
    G[4,1] <- causality(var2,cause = "RGDP_Growth")$Granger[4]
    G[4,2] <- as.numeric(as.character(causality(var2,cause = "RGDP_Growth")$Granger[1]))
    G[4,3] <- as.numeric(as.character(causality(var2,cause = "RGDP_Growth")$Granger[3]))
    
    G[5,1] <- causality(var3,cause = "Dispersion")$Granger[4]
    G[5,2] <- as.numeric(as.character(causality(var3,cause = "Dispersion")$Granger[1]))
    G[5,3] <- as.numeric(as.character(causality(var3,cause = "Dispersion")$Granger[3]))
    G[6,1] <- causality(var3,cause = "RGDP_Growth")$Granger[4]
    G[6,2] <- as.numeric(as.character(causality(var3,cause = "RGDP_Growth")$Granger[1]))
    G[6,3] <- as.numeric(as.character(causality(var3,cause = "RGDP_Growth")$Granger[3]))

    G[7,1] <- causality(var4,cause = "Uncertainty")$Granger[4]
    G[7,2] <- as.numeric(as.character(causality(var4,cause = "Uncertainty")$Granger[1]))
    G[7,3] <- as.numeric(as.character(causality(var4,cause = "Uncertainty")$Granger[3]))
    G[8,1] <- causality(var4,cause = "RGDP_Growth")$Granger[4]
    G[8,2] <- as.numeric(as.character(causality(var4,cause = "RGDP_Growth")$Granger[1]))
    G[8,3] <- as.numeric(as.character(causality(var4,cause = "RGDP_Growth")$Granger[3]))
    
    G[,2:3] <- round(G[,2:3],3)
    mystars <- ifelse(G[,3] < .01, "***", ifelse(G[,3] < .05, "** ", ifelse(G[,3] < .1, "* ", " ")))
    Gnew <- matrix(paste(G[,2], mystars, sep=""), ncol=1) 
    G[,1] <- sub(".*: ", "", G[,1])
    G[,2] <- Gnew
    colnames(G) <- c("Granger causality H0:","statistic","p-value")
    
    return(G)
}

G_manu <- calc_sectoralvar(manufac2)
G_build <- calc_sectoralvar(construct2)
G_trade <- calc_sectoralvar(trade2)
G_serv <- calc_sectoralvar(services2)

G_sector <- cbind(G_manu[,1:2],G_build[,2],G_trade[,2],G_serv[,2])
colnames(G_sector)[2:5] <- c("Manufacturing", "Construction","Trade","Services")

xt <- xtable(G_sector, caption="Granger causality tests: Sectoral Uncertainty")
print(xt, "latex", include.rownames=FALSE,comment=FALSE, caption.placement = getOption("xtable.caption.placement", "top"), 
      scalebox = 0.8)
```

###VAR Analysis
This section provides evidence on the dynamic effects of sentiment shocks on real economic activity. As many economic variables move together over times, without an obvious causal direction, it can be challenging to identify the direction of relationships. The literature has often relied on timing for identification. This section follows the literature (e.g. @Taylor2007; @Barsky2012; @Bachmann2013) in using standard recursive VARs to trace out the dynamic responses of economic activity to surprise shocks in sentiment. The aim is to investigate whether these measures have a significant dynamic relationship with real output, and whether shock to sentiment generate responses which are in line with the theory. 

The relationships are investigated for the aggregate variables, as well as for each sector separately, using bivariate recursive VARs featuring a measure of sentiment and real GDP growth. A bivariate system is a parsimonious way to model the joint dynamics of sentiment and real economic activity [@Bachmann2013]. In the bivariate case, both variables are treated as endogenous:
$$y_t = \beta_{10} - \beta_{12} z_t + \gamma_{11} y_{t-1} + \gamma_{12} z_{t-1} + \epsilon_{yt}$$
$$z_t = \beta_{20} - \beta_{21} y_t + \gamma_{21} y_{t-1} + \gamma_{22} z_{t-1} + \epsilon_{zt}$$
where $y$ is output, $z$ is sentiment, and $\epsilon$ is the residual of each equation. 

A range of VARs are estimated on the quarterly data running from 1992Q1 to 2015Q3. The indicators enter in levels, while the real GDP series enter as annual quarter-on-quarter growth rates, which corresponds to the survey reference period. Unit root tests indicate that virtually all of the aggregate and sectoral indicators and the corresponding real GDP growth rates are stationary. The exception is real GDP growth in the services sector, which may be due to the shorter sample period. The appropriate number of lags are selected by means of the Akaike information criterion (AIC), the Schwarz criterion (SC) and the Hannan-Quinn criterion (HQ). The most parsimonious model is selected, provided that the diagnostic tests (i.e. no serial correlation, homoscedasticity and normality) are satisfied. In the majority of cases the information criteria point to 2 lags. The model fit is best when a constant term is included. 

The sentiment indicators are ordered first in a recursive identification strategy, with the Cholesky decomposition used to identify structural shocks. With this ordering, shocks to sentiment are allowed to have a contemporaneous impact on activity, but shocks to activity have no contemporaneous impact on sentiment ($\beta_{21} = 0$). In other words, innovations to the confidence indicators influence economic activity on impact, but not vice versa. This is the identification strategy and ordering used in the literature (e.g. @Leduc2013, @Bachmann2013, @Girardi2015, @Baker2015, and @Redl2015). It can be motivated by the timing of the surveys before the release of most macroeconomic data [@Leduc2015]. When the survey is completed in time $t$ the respondents do not know the realisations of output growth in time $t$, as the response deadline is generally the second month of the quarter. 

####Confidence
Impulse response functions (IRFs) can be generated to illustrate the dynamic impact of a shock to sentiment on the system. The shock is an innovation to the residual in the equation. Figure 3.14 illustrates the IRFs of a bivariate VARs for the Activity indicator and real GDP growth. The left panel plots the responses of real GDP growth to an orthogonal shock in the indicator, with 95% bootstrap confidence intervals. Following an increase in confidence, real GDP growth increases by around 0.3% on impact, with a peak at 3 quarters. The impact on the growth rate is transitory, dying out after approximately 7 quarters. This is equivalent to a permanent increase in the level of output, which confirms the findings in the literature (e.g. @Barsky2012). The right panel plots the response of Activity to an orthogonal shock in real GDP growth. Following an increase in real GDP growth, there is an insignificant increase in Activity of around 2% after two quarters. The results are virtually identical for the Confidence indicator and the BER BCI, whereas the SACCI BCI does not exhibit a significant relationship with real activity. The results are similar for alternative orderings.

```{r figure3.14, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="IRFs of Activity and real GDP growth"}
vardat <- cbind(conf_indices[,2],conf_indices[,6])
colnames(vardat) <- c("Activity","RGDP_Growth")
infocrit <- VARselect(vardat, lag.max = 12, type = "const")
k_aic <- infocrit$selection[1]
k_hq  <- infocrit$selection[2]
k_sic <- infocrit$selection[3]
k <- min(k_aic,k_sic,k_hq)
var1 <- VAR(vardat,p=k,type="const")

irf.y1 <- irf(var1,impulse = "Activity", response = "RGDP_Growth", n.ahead = 12,runs = 1000, seed=12345) 
irf.y2 <- irf(var1,impulse = "RGDP_Growth", response = "Activity", n.ahead = 12,runs = 1000, seed=12345)

par(mfrow=c(1,1), new=FALSE)
nf <- layout(matrix(c(1,2,1,2), 1, 2, byrow = TRUE))
#layout.show(nf)
#par(cex=1)
plot(irf.y1,plot.type = c("single"), main="Response from Activity", xlab="Horizon in quarters")
par(new = TRUE)
plot(irf.y2,plot.type = c("single"), main="Response from RGDP Growth", xlab="Horizon in quarters")
```

The importance of innovations can also be examined with variance decompositions. While the IRFs describe the reaction of a variable of interest to an exogenous shock, the decomposition of the forecast error variance of a given variable shows how much of the error can be explained by exogenous shocks to the other variables in the system [@Girardi2015]. The forecast error variance decomposition (FEVD) shows the proportion of the movements in a sequence due to its own shocks and shocks to the other variable. Figure 3.15 illustrates the FEVDs for the Activity indicator and real GDP growth. Up to around half (52%) of the movements in real GDP growth are explained by the confidence indicator over the longer term, while real GDP explains up to 3% of the variance in the Activity indicator.

```{r figure3.15, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="FEVDs of Activity and real GDP growth"}
source("plot_varfevd.R")
par(mfrow=c(1,2))
plot.varfevd(fevd(var1, n.ahead = 10 ),plot.type = "single")    

```

The results for the sectoral indicators are very similar to the aggregate results. Figure 3.16 illustrates the IRFs of a bivariate VARs for the Manufacturing Activity indicator and real GDP growth in the Manufacturing sector. Following an increase in confidence, real GDP growth increases on impact, with a peak at 2 quarters. The impact on the growth rate dies out after approximately 4 quarters. Following an increase in real GDP growth, there is a significant increase in Activity in the following quarter. The results are similar for alternative orderings. The results for the other sectoral indicators are very similar to those for the Manufacturing sector, with the exception that in the Construction sector the impact of a shock to Activity on GDP growth does not die out within the forecast horizon of 12 quarters.

```{r figure3.16, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="IRFs of Activity and real GDP growth in the Manufacturing sector"}
vardat <- cbind(manufac[,2],manufac[,5])
colnames(vardat) <- c("Activity","RGDP_Growth")
infocrit <- VARselect(vardat, lag.max = 12, type = "const")
k_aic <- infocrit$selection[1]
k_hq  <- infocrit$selection[2]
k_sic <- infocrit$selection[3]
k <- min(k_aic,k_sic,k_hq)
varm <- VAR(vardat,p=k,type="const")

irf.y1 <- irf(varm,impulse = "Activity", response = "RGDP_Growth", n.ahead = 12,runs = 1000, seed=12345) 
irf.y2 <- irf(varm,impulse = "RGDP_Growth", response = "Activity", n.ahead = 12,runs = 1000, seed=12345)

par(mfrow=c(1,1), new=FALSE)
nf <- layout(matrix(c(1,2,1,2), 1, 2, byrow = TRUE))
#layout.show(nf)
#par(cex=1)
plot(irf.y1,plot.type = c("single"), main="Response from Activity", xlab="Horizon in quarters")
par(new = TRUE)
plot(irf.y2,plot.type = c("single"), main="Response from RGDP Growth", xlab="Horizon in quarters")
```

Figure 3.17 illustrates the FEVDs for the Activity indicator and real GDP growth in the Manufacturing sector. Up to more than a third (39%) of the movements in real GDP growth are explained by Activity over the longer term, while real GDP explains up to 2% of the variance in Activity. Overall, the results suggest that shocks to confidence are important for economic fluctuations, accounting for between around 20% and 60% of the forecast error variance of the real GDP growth rate, depending on the level of aggregation and the indicator used.

```{r figure3.17, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="FEVDs of Activity and real GDP growth in the Manufacturing sector"}
source("plot_varfevd.R")
par(mfrow=c(1,2))
plot.varfevd(fevd(varm, n.ahead = 10 ),plot.type = "single")
```

####Uncertainty
Figure 3.18 illustrates the IRFs of a bivariate VAR with Dispersion and real GDP growth. The left panel plots the responses of real GDP growth to an orthogonal shock in Dispersion, with 95% bootstrap confidence intervals. A shock to Dispersion is followed by a mildly significant decrease in real GDP growth. The right panel plots the responses of Dispersion to an orthogonal shock in real GDP growth. Following a shock to real GDP growth, there is no significant response in Dispersion. The IRFs for the Aggregate, EPU, and SAVI indicators of uncertainty are almost identical. A shock to these indicators is associated with a mildly significant decrease in real GDP growth, while a shock to real GDP growth does not lead to a significant change in each of the uncertainty indicators. The results are similar for alternative orderings.

```{r figure3.18, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="IRFs of Uncertainty and real GDP growth"}
vardat <- cbind(uncert_indices[,2],conf_indices[,6])[-95,]
colnames(vardat) <- c("Dispersion","RGDP_Growth")
infocrit <- VARselect(vardat, lag.max = 12, type = "const")
k_aic <- infocrit$selection[1]
k_hq  <- infocrit$selection[2]
k_sic <- infocrit$selection[3]
k <- min(k_aic,k_sic,k_hq)
var1 <- VAR(vardat,p=k,type="const")

irf.y1 <- irf(var1,impulse = "Dispersion", response = "RGDP_Growth", n.ahead = 12,runs = 1000, seed=12345) 
irf.y2 <- irf(var1,impulse = "RGDP_Growth", response = "Dispersion", n.ahead = 12,runs = 1000, seed=12345)

par(mfrow=c(1,1), new=FALSE)
nf <- layout(matrix(c(1,2,1,2), 1, 2, byrow = TRUE))
#layout.show(nf)
#par(cex=1)
plot(irf.y1,plot.type = c("single"), main="Response from Dispersion", xlab="Horizon in quarters")
par(new = TRUE)
plot(irf.y2,plot.type = c("single"), main="Response from RGDP Growth", xlab="Horizon in quarters")
```

Figure 3.19 illustrates the IRFs of a bivariate VAR with the overall Uncertainty indicators and real GDP growth. A shock to Uncertainty is followed by a significant decrease in real GDP growth on impact, with a peak at 3 quarters. The impact on the growth rate is transitory, dying out after approximately 6 quarters. This result confirms the findings in most of the literature (e.g. @Bachmann2013 and @Redl2015), where innovations to uncertainty have protracted negative effects on economic activity. 

```{r figure3.19, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="IRFs of Uncertainty and real GDP growth"}
vardat <- cbind(uncert_indices[,7],conf_indices[,6])[-95,]
colnames(vardat) <- c("Uncertainty","RGDP_Growth")
infocrit <- VARselect(vardat, lag.max = 12, type = "const")
k_aic <- infocrit$selection[1]
k_hq  <- infocrit$selection[2]
k_sic <- infocrit$selection[3]
k <- min(k_aic,k_sic,k_hq)
var1 <- VAR(vardat,p=k,type="const")

irf.y1 <- irf(var6,impulse = "Uncertainty", response = "RGDP_Growth", n.ahead = 12,runs = 1000, seed=12345) 
irf.y2 <- irf(var6,impulse = "RGDP_Growth", response = "Uncertainty", n.ahead = 12,runs = 1000, seed=12345)

par(mfrow=c(1,1), new=FALSE)
nf <- layout(matrix(c(1,2,1,2), 1, 2, byrow = TRUE))
#layout.show(nf)
#par(cex=1)
plot(irf.y1,plot.type = c("single"), main="Response from Uncertainty", xlab="Horizon in quarters")
par(new = TRUE)
plot(irf.y2,plot.type = c("single"), main="Response from RGDP Growth", xlab="Horizon in quarters")
```

Figure 3.20 illustrates the FEVDs for the overall Uncertainty indicator and real GDP growth. Up to around 20% of the movements in real GDP growth are explained by the Uncertainty indicator over the longer term, while real GDP explains about 2% of the variance in Uncertainty. This is in line with findings in the literature (e.g. @Bachmann2013).

```{r figure3.20, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="FEVDs of Activity and real GDP growth"}
source("plot_varfevd.R")
par(mfrow=c(1,2))
plot.varfevd(fevd(var6, n.ahead = 10 ),plot.type = "single")

```

Figure 3.21 illustrates the IRFs of a bivariate VAR for the Manufacturing Uncertainty indicator and real GDP growth in the Manufacturing sector. A shock to Uncertainty is followed by a mildly significant decrease in real GDP growth, with a peak at 2 quarters. The FEVDs illustrated Figure 3.22 show that around 30% of the movements in real Manufacturing GDP growth are explained by Uncertainty over the longer term. There is no a consistent negative relationship for any single indicator and real GDP growth in the other three sectors. In the Construction sector only the Aggregate uncertainty indicator has a significant negative impact on real GDP growth. In the Trade sector the Dispersion and Aggregate indicators have a significant negative impact, while none of the indicators have a significant relationship in the Services sector. 

```{r figure3.21, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="IRFs of Uncertainty and real GDP growth in the Manufacturing sector"}
vardat <- cbind(manufac2[,5],manufac2[,6])
colnames(vardat) <- c("Uncertainty","RGDP_Growth")
infocrit <- VARselect(vardat, lag.max = 12, type = "const")
k_aic <- infocrit$selection[1]
k_hq  <- infocrit$selection[2]
k_sic <- infocrit$selection[3]
k <- min(k_aic,k_sic,k_hq)
varm <- VAR(vardat,p=k,type="const")

irf.y1 <- irf(varm,impulse = "Uncertainty", response = "RGDP_Growth", n.ahead = 12,runs = 1000, seed=12345) 
irf.y2 <- irf(varm,impulse = "RGDP_Growth", response = "Uncertainty", n.ahead = 12,runs = 1000, seed=12345)

par(mfrow=c(1,1), new=FALSE)
nf <- layout(matrix(c(1,2,1,2), 1, 2, byrow = TRUE))
#layout.show(nf)
#par(cex=1)
plot(irf.y1,plot.type = c("single"), main="Response from Uncertainty", xlab="Horizon in quarters")
par(new = TRUE)
plot(irf.y2,plot.type = c("single"), main="Response from RGDP Growth", xlab="Horizon in quarters")
```

```{r figure3.22, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="FEVDs of Uncertainty and real GDP growth in the Manufacturing sector"}
source("plot_varfevd.R")
par(mfrow=c(1,2), new = FALSE)
plot.varfevd(fevd(varm, n.ahead = 10 ),plot.type = "single")

```

####Expanded VAR
Though instructive, the results from a bivariate system are prone to misspecification [@Girardi2015]. In order to test the robustness of the negative effect of uncertainty shocks, a number of authors have extended the baseline setup to include measures of confidence (@Girardi2015, @Leduc2015, @Baker2015 and @Bachmann2010). Periods of increased uncertainty also tend to be periods of bad economic news. Confidence is usually included to control for the possibility that the impact of uncertainty may reflect respondents' perceptions of bad news rather than an uncertain future [@Baker2015]. 

Figure 3.23 illustrates the Activity measure of confidence and the combined Uncertainty indicator, with recessionary periods shaded. The two sentiment indicators do not appear to be mirror images of each other, with a correlation of -0.3. Although confidence is pro-cyclical and uncertainty is mostly anti-cyclical, they appear to capture different phenomena. 

```{r figure3.23, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4.5, fig.width=7.5, fig.cap="Confidence (Activity) and Uncertainty (Combined)"}
index_plot <- cbind(conf_indices[,c(1,2)],uncert_indices$Uncertainty) 
index_plot[,-1] <- scale(index_plot[,-1])
colnames(index_plot) <- c("Date","Activity","Uncertainty")
g <- ggplot(index_plot) 
g <- g + geom_line(aes(x=Date, y=Activity, colour="Activity"), size = 1)
g <- g + geom_line(aes(x=Date, y=Uncertainty, colour="Uncertainty"), size = 1)
g <- g + labs(color="Legend text")
g <- g + geom_rect(data=recessions.df, aes(xmin=Peak, xmax=Trough, ymin=-Inf, ymax=+Inf), fill='grey', alpha=0.5)
g <- g + ylab("Indicator") + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank()) 
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"), expand=c(0,0),
                      limits = as.Date(c("1990-12-31", NA)))
g <- g + theme(legend.position="bottom")
g
```

Figure 3.24 illustrates the IRFs of a three-variable VARs including confidence, uncertainty and real GDP growth. Following @Girardi2015, confidence is ordered first under a recursive identification scheme. The results are very similar to the IRFs for the bivariate VARs reported earlier. A shock to confidence is followed by a significant positive increase in real GDP growth, while a shock to uncertainty is followed by a decrease in real GDP growth. The decrease in output growth following an Uncertainty shock is less significant compared to the previous results. This suggests that confidence does proxy for part of the predictive power of the uncertainty measure [@Baker2015]. Figure 3.25 illustrates the FEVDs for this 3-variable VAR. Up to around half of the movements in real GDP growth are explained by confidence over the longer term, while uncertainty explains around 10% of the movements in real GDP growth.

```{r var.sent, echo=FALSE, results='hide', message=FALSE, warning=FALSE, cache = TRUE}
Activity <- conf_indices[,2]
Uncertainty <- uncert_indices[,7]
RGDP_Growth <- conf_indices[,6]

vardat <- cbind(Activity,Uncertainty,RGDP_Growth)  
infocrit <- VARselect(vardat, lag.max = 16, type = "const")
k_aic <- infocrit$selection[1]
k_hq  <- infocrit$selection[2]
k_sic <- infocrit$selection[3]
k <- min(k_aic,k_sic,k_hq)
var_3 <- VAR(vardat,p=k,type="const")
```

```{r figure3.24, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4, fig.width=7.5, fig.cap="IRFs of real GDP growth to confidence and uncertainty in the 3-variable VAR"}
irf.y1 <- irf(var_3,impulse = c("Activity","Uncertainty"), response = "RGDP_Growth", n.ahead = 12,runs = 1000, seed=12345) 
par(mfrow=c(1,2),mar=c(5,4,4,2), cex=0.5)
plot(irf.y1,plot.type = c("single"))
```

```{r figure3.25, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4, fig.width=7.5, fig.cap="FEVDs of 3-variable VAR"}
source("plot_varfevd.R")
par(mfrow=c(1,3))
plot.varfevd(fevd(var_3, n.ahead = 10 ),plot.type = "single")
```

A larger VAR system is also estimated to test the robustness of the relationships. The extended VAR includes the variables suggested by @Redl2015 for South Africa: confidence, uncertainty, the JSE All Share Index, the yield spread (i.e. the Government Bond Yield minus the 3-month T-Bill rate), GDP, industrial production, investment, and an employment index. These variables are typically included in the literature (e.g. @Leduc2013, @Bachmann2013, and @Baker2015). 

The variables are ordered with the sentiment variables first, the financial variables next and the real variables last. The financial variable are expected to move faster than the real variables [@Redl2015]. An alternative ordering of placing the sentiment indicators last provides qualitatively similar results. As was the case in the previous VARs, the variables enter as real annual quarter-on-quarter growth rates, except for the sentiment indices and the yield spread. The model is estimated with two lags, with the caveat that the information criteria indicate that more than the maximum amount of lags are appropriate. The results with 4 lags are also qualitatively similar. 

The IRFs for the impact of Activity and Uncertainty on the growth rate of real GDP, real production and real investment are illustrated in Figure 3.26. The top panels illustrate the responses of the real variables to a shock in Activity, and the bottom panels shows the responses to a shock in Uncertainty. The larger system seems to provide similar results to the findings in bivariate VARs. The response real GDP growth are similar to those in the 3-variable model, although the Uncertainty shock loses its significance. The impact of the shocks are larger on real production and investment growth than on real GDP growth. This is what the wait-and-see theory would predict. The responses of employment (not illustrated) are very similar to those of real GDP growth. According to the FEVD, Activity explains around 35%, 30%, and 40% of the variance in real GDP growth, real production growth and real investment growth, while Uncertainty explains around 10%, 15% and 10% of the variance in the three real variables.

```{r var.exp, echo=FALSE, results='hide', message=FALSE, warning=FALSE, cache = TRUE}
JSE <- GDPgrowth4$RJSE
Bond <- GDPdata$Bond2
TBill <- GDPdata$T.Bill
Spread <- Bond-TBill
Employment <- GDPgrowth4$Employ
Investment <- GDPgrowth4$Rinvestment 
Production <- GDPgrowth4$RProduction

vardat <- cbind(Activity,Uncertainty,JSE,Spread,RGDP_Growth,
                Production,Employment,Investment)  
vare <- VAR(vardat,p=2,type="const")
```

```{r figure3.26, echo=FALSE, warning=FALSE, cache = TRUE, fig.height=4, fig.width=7.5, fig.cap="IRFs of real GDP growth to confidence and uncertainty in the extended VAR"}
irf.y1 <- irf(vare,impulse = c("Activity","Uncertainty"),
              response = c("RGDP_Growth","Production","Investment"), n.ahead = 12,runs = 1000, seed=12345) 
par(mfrow=c(2,3),mar=c(3,4,2,1), cex=0.6)
plot(irf.y1,plot.type = c("single"), main="")
```

###Summary and Suggested Future Research
The results reported in this section suggest that all 3 survey-based confidence indicators contain relevant information for predicting output growth. The lagged values of all 3 survey-based confidence indicators significantly Granger-caused real GDP growth, with limited evidence of Granger-causality in the reverse direction. The indicators had a positive and significant impact on real GDP growth in the VAR models.

Shocks to the indicators accounted for a sizeable fraction of variation in economic activity. This is the case for the aggregate indicators as well as the sectoral indicators. This implies that the confidence indicators contain useful information about current and future economic developments. As a result, the confidence indicators may be useful for monitoring economic developments in a timely manner and for forecasting future economic activity. The new composite indicators seem to outperform the existing confidence indicators, in terms of tracking record, the stability of turning points, and the size of impulse responses.

The results from the VAR analysis indicated that a shock to this Uncertainty indicator was followed by a significant decrease in real GDP growth, with a peak at 3 quarters. The impact on the growth rate was transitory, dying out after approximately 6 quarters. This result confirms the findings in most of the literature, where innovations to uncertainty have protracted negative effects on economic activity. 

The results from the larger VAR systems seems confirm the findings in bivariate VARs. The response real GDP growth are similar to those in the 3-variable model, although the Uncertainty shock loses its significance. The impact of the shocks are larger on real production and investment growth than on real GDP growth, which what the wait-and-see theory would predict. The results seem to provide evidence at least of important comovement between the indicators of sentiment and real economic activity, which should be investigated further [@Baker2015]. A number of studies have estimated these larger systems in levels, as opposed to the growth rates used above. Further analysis could investigate larger systems in levels, which may allow longer term relationships to emerge and uncover relationships between other variables and the sentiment indicators.

A future avenue for investigation would be to assess the usefulness of the indicators in improving out-of-sample forecasts. Significant in-sample evidence of forecasting power does not guarantee significant out-of-sample ability. The usefulness of the indicators for real-time forecasting could also be analysed, given that they are available around two months before many official series.

A future avenue for investigation would be to test whether there is asymmetry in the frequency horizon of shock effects. Deeper or systemic shocks may be associated with medium-term, rather than high-frequency fluctuations in output. An extension would be to test whether the relationship is non-linear or asymmetric, depending on the size or duration of the change in sentiment. The forecasting ability of the indicators might be completely offset by other indicators during ordinary times, while increasing notably in the presence of unusual events. For instance, shocks to sentiment might only play an important role during episodes of economic tensions, associated with large decreases in confidence and large increases in uncertainty. Moreover, the relation during a recovery phase (and potentially late stages of a recession) may be different from the relation during the rest of an expansion. It may also be instructive to determine what factors influence the indicators of sentiment.

##Conclusion
To date there has been little research on business sentiment in South Africa, in part due to the difficulty of constructing proxies for these elusive concepts. The primary aim of this chapter was to explore aggregation methods to estimate proxies for business confidence and uncertainty using the microeconomic data from the BER business tendency surveys. 

The challenge in aggregating the microeconomic data from the BER business tendency surveys is to identify an underlying pattern from the disparate views of individual agents. The chapter used different combinations of the weighted cross-sectional first and second moments of the distribution of the qualitative survey responses to create composite indicators for confidence and uncertainty. The composite indicators incorporated the survey responses from a number of questions. The responses were weighted to produce sectoral and aggregate indicators, which were analysed separately. 

Two new composite confidence indicators were created. The composite indicators seemed plausible and exhibited a significant positive correlation with real GDP growth. The indicators provided advanced warning of business cycle turning points, although there were a few false signals. The new composite indicators outperformed the existing confidence indicators in terms of their correlation with real GDP growth (tracking record) and their concordance with the business cycle.

Three new sets of composite indicators of uncertainty were calculated. The indicators were counter-cyclical in the sense that they exhibited a significant negative correlation with real GDP growth, albeit at different horizons. The survey-based indicators were combined with measures of financial market and economic policy uncertainty to form an overall uncertainty indicator. This combined indicator appeared to be a plausible proxy of macroeconomic uncertainty in South Africa, reflecting key economic events. It also tracked real GDP growth rates more closely than the individual components separately. 

The secondary aim of this chapter was to examine the relationship between business sentiment and real economic activity in South Africa, by testing the hypothesis that there is significant comovement between the sentiment indicators and real GDP growth. In the VAR models, a shock to the confidence indicators was followed by a significant increase in real GDP growth. A shock to the combined uncertainty indicator was followed by a significant decrease in real GDP growth. This was the case for the aggregate indicators as well as the sectoral indicators. The results from the larger VAR systems confirmed the findings in bivariate VARs, although the significance of the uncertainty shock declined. The impact of the shocks were larger on real production and investment growth than on real GDP growth. The results provide evidence at least of important comovement between the indicators of sentiment and real economic activity. The indicators may therefore be useful for monitoring economic developments in a timely manner and seem to contain relevant information for predicting output growth.

The chapter has attempted to make three contributions to the literature. The first was to demonstrate aggregation methods to estimate sentiment indicators from the disparate qualitative responses of individual firms. While the previous chapter created various quality-adjusted measures of the mean of the distribution of growth rates, this chapter calculated various measures of the mean and variance of survey responses. 

The weighted cross-sectional moments employed in this chapter would be useful in other applications with qualitative survey responses, such as consumer surveys, where there are challenges capturing the full richness in the data and the full distribution of responses. Consumer confidence measures are popular indicators and calculated all over the world, often using qualitative surveys. Popular international confidence indicators include the European Commission's Economic Sentiment Index and the University of Michigan consumer confidence measure for the US [@INIS2014]. The BER calculates consumer confidence using their consumer tendency surveys. It would be possible to improve on the existing measures of consumer confidence using the techniques demonstrated in this chapter to capture more of the richness in the data. Moreover, it would be possible create new measures of consumer uncertainty, by calculating the weighted cross-sectional dispersion in responses. 

The second contribution was to apply these aggregation methods to a relatively large microeconomic database of survey responses to construct new composite indicators of confidence and uncertainty for South Africa. The third was to use these indices to test for a significant relationship between the sentiment indicators and economic activity. 

The new composite indicators of confidence and uncertainty, reported in the Appendix below, may be useful for a range of applications. For instance, the confidence indicators might be useful for forecasting and nowcasting exercises and to provide and early warning signals for business cycle turning points. The uncertainty indicator could be used to further investigate the importance of uncertainty shocks for business cycle fluctuations and credit cycles, and whether this relationship is non-linear or asymmetric. It may also be used to inform other analyses, such as the influence of uncertainty on the responsiveness of exports to relative price changes studied in @Hlatshwayo2016. It may also be informative to investigate the factors that drive the indicators of sentiment. The new sentiment indicators may facilitate these inquiries.

\newpage
##Appendix
```{r ap2, echo=FALSE, results='asis',warning=FALSE, message=FALSE, cache = TRUE, fig.pos='H'}
setwd("C:\\Users\\Laurie\\OneDrive\\Documents\\BING\\BER Confidence Surveys\\Sentiment")
suppressMessages(library(xtable))

conf_indices <- read.csv2("conf_indices.csv")[,-1]
uncert_indices <- read.csv2("uncert_indices.csv")[,-1]

all_indices <- cbind(conf_indices[,c(1:3)],uncert_indices[,c(2:4,7)])
xt <- xtable(all_indices[1:48,], caption="Sentiment Indicators")
print(xt, "latex",comment=FALSE, include.rownames=FALSE,
      caption.placement = getOption("xtable.caption.placement", "top"),scalebox=0.65)

```


```{r ap3, echo=FALSE, results='asis',warning=FALSE, message=FALSE, cache = TRUE}
setwd("C:\\Users\\Laurie\\OneDrive\\Documents\\BING\\BER Confidence Surveys\\Sentiment")
suppressMessages(library(xtable))

conf_indices <- read.csv2("conf_indices.csv")[,-1]
uncert_indices <- read.csv2("uncert_indices.csv")[,-1]

all_indices <- cbind(conf_indices[,c(1:3)],uncert_indices[,c(2:4,7)])
xt <- xtable(all_indices[48:95,])
print(xt, "latex",comment=FALSE, include.rownames=FALSE,
      scalebox=0.65)

```



